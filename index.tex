% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={R pour ma grand-mère},
  pdfauthor={Vincent Bonhomme},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{R pour ma grand-mère}
\author{Vincent Bonhomme}
\date{2024-04-13}

\begin{document}
\maketitle
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[sharp corners, enhanced, frame hidden, borderline west={3pt}{0pt}{shadecolor}, breakable, interior hidden, boxrule=0pt]}{\end{tcolorbox}}\fi

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\hypertarget{pruxe9face}{%
\chapter*{Préface}\label{pruxe9face}}
\addcontentsline{toc}{chapter}{Préface}

\markboth{Préface}{Préface}

\hypertarget{uxe0-propos-de-louvrage}{%
\section*{À propos de l'ouvrage}\label{uxe0-propos-de-louvrage}}
\addcontentsline{toc}{section}{À propos de l'ouvrage}

\markright{À propos de l'ouvrage}

La vocation de cet ouvrage est de fournir un point de départ rapide mais
solide aux principaux usages de R, un environnement complet et
open-source pour l'analyse de données.

L'auteur a tenté d'écrire la ressource qu'il aurait aimé avoir à ses
débuts, dans l'esprit de ses deux références chéries :
\href{https://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr}{\emph{R
pour les débutants}} d'Emmanuel Paradis et
\href{https://r4ds.hadley.nz/}{\emph{R for data science}} d'Hadley
Wichkam. Une sélection de références plus complètes et/ou plus
spécifiques, sont listées.

Il sert de compagnon à une formation pour des absolu·e·s débutant·e·s
sur une durée présentielle de 3 jours (18h). Son intention est
d'autonomiser ces utilisateur·trice·s tout en espérant être utiles aux
non-néophytes voire aux plus assidu·e·s.

Le titre est un hommage à ma grand-mère, certes plus intarissable sur la
sociologie provençale des années 1950 que sur la coercion de classe à la
volée.

\hypertarget{uxe0-propos-de-lauteur}{%
\section*{À propos de l'auteur}\label{uxe0-propos-de-lauteur}}
\addcontentsline{toc}{section}{À propos de l'auteur}

\markright{À propos de l'auteur}

Je suis biologiste de l'évolution de formation et aujourd'hui
consultant, formateur et chercheur associé à l'UMR ISEM à Montpellier.
J'utilise R quotidiennement depuis 2006 et je suis l'auteur de nombreux
packages dont \href{https://github.com/MomX/Momocs}{Momocs}, pour
l'analyse de forme.

Je suis disponible pour de la consultance et des formations sur à peu
près tous les ``niveaux'' d'utilisation de R, depuis le tout début
jusqu'au packaging et la contruction d'interface conviviales ala shiny.

En \emph{side project}, j'ai confondé
\href{https://www.cevennette.fr}{Cévennette} qui conçoit et fabrique des
toilettes sèches à séparation, sans odeur et sans copeaux, pour les
particuliers, les événements et les collectivités.

Si vous avez envie de faire pipi ou si vous cherchez un formateur ou un
consultant en R, voici mes contacts :

\begin{itemize}
\tightlist
\item
  \href{https://www.vincentbonhomme.fr}{www.vincentbonhomme.fr}
\item
  \href{mailto:bonhomme.vincent@gmail.com}{\nolinkurl{bonhomme.vincent@gmail.com}}
\end{itemize}

\hypertarget{code-source}{%
\section*{Code source}\label{code-source}}
\addcontentsline{toc}{section}{Code source}

\markright{Code source}

\begin{itemize}
\tightlist
\item
  Si vous le lisez en pdf, il est disponible en ligne ici :
  \href{}{https://vbonhomme.github.io/R-pour-ma-grand-mere}.
\item
  Si vous le lisez en ligne, il est disponible en pdf
  \href{https://github.com/vbonhomme/R-pour-ma-grand-mere/blob/main/_book/R-pour-ma-grand-m\%C3\%A8re.pdf}{ici}
\item
  Ce document Quarto est écrit en Rmarkdown et hébergé par Github:
  {[}https://github.com/vbonhomme/R-pour-ma-grand-mere{]}
\item
  Si vous êtes à l'aise sur Github, vous pouvez directement modifier le
  contenu que j'approuverai (ou non), pour corriger une erreur, une
  coquille, etc. Si vous souhaitez simplement suggérer une modification
  ou signaler un problème, vous pouvez très simplement ouvrir un
  ``ticket'' dans l'onglet ``Issues''.
\end{itemize}

\hypertarget{licence}{%
\section*{Licence}\label{licence}}
\addcontentsline{toc}{section}{Licence}

\markright{Licence}

Ce document est placé par l'auteur sous licence CC0, ce qui signifie que
vous pouvez en faire absolument ce que vous voulez, sans me demander
quoique ce soit. Naturellement, me citer est néanmoins bon pour votre
karma !

\hypertarget{conventions}{%
\section*{Conventions}\label{conventions}}
\addcontentsline{toc}{section}{Conventions}

\markright{Conventions}

Le code en ligne utilisera \texttt{une\ police\ de\ ce\ type}; les blocs
ressemblent à celui ci :

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# this is a comment}
\DecValTok{3}\SpecialCharTok{+}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7
\end{verbatim}

Généralement, le résultat s'affiche à proximité et vous pouvez
copier-coller ce code dans R (ou cliquer sur le bouton en haut à droite
du cadre) et obtenir le même résultat sur votre machine. Tout ce qui
suit un \texttt{\#} est un commentaire - lisez-les ! - et est ignoré par
R.

Parfois, une maxime de sagesse populaiRe est insérée dans un bloc comme
ci-dessous. Promis, elles ne réfèrent pas toutes au sous-vêtements.

\begin{quote}
Les statistiques sont comme les petites culottes : elles montrent le
superflu et cachent l'essentiel.
\end{quote}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\bookmarksetup{startatroot}

\hypertarget{installer-un-environnement-r}{%
\chapter{Installer un environnement
R}\label{installer-un-environnement-r}}

Je préconise l'installation conjoint de R et de RStudio son IDE
(environnement de travail intégré). Vous pouvez faire sans RStudio mais
je vous le déconseille.

\hypertarget{r}{%
\section{R}\label{r}}

L'installation de R se passe généralement sans encombres, en quelques
minutes.

Le plus simple est de choisir votre système d'exploitation depuis la
page officielle :

\begin{quote}
\url{https://cran.rstudio.com/}.
\end{quote}

Pour Windows et Mac, il suffit de télécharger et d'installer l'archive.
Pour Mac, comme indiqué sur la page en lien, il vous faudra probablement
également installer XQuartz. Sous Linux, vous serez guidés pour utiliser
votre gestionnaire de paquets préféré.

\hypertarget{rstudio}{%
\section{RStudio}\label{rstudio}}

Pour installer RStudio, version bureau, récupérez l'installeur depuis sa
page d'accueil et laissez vous porter :

\begin{quote}
\href{\%5Bhttps://posit.co/download/rstudio-desktop/\%5D}{https://posit.co/download/rstudio-desktop/}
\end{quote}

\hypertarget{vuxe9rifier-votre-installation}{%
\section{Vérifier votre
installation}\label{vuxe9rifier-votre-installation}}

Une fois que vous avez installé R puis RStudio, ouvrez RStudio.

Dans la fenêtre ``console'', là où vous voyez une invite de commande
\texttt{\textgreater{}} tapez 1+1 puis
\texttt{\textless{}Entrée\textgreater{}}. Voilà, vous avez une
installation de R+RStudio qui fonctionne.

\hypertarget{installer-les-packages}{%
\section{Installer les packages}\label{installer-les-packages}}

Les besoins de ce document se limitent aux packages du
\href{https://www.tidyverse.org/}{tidyverse} que vous pouvez installer
en tapant à la console la commande suivante :

\begin{quote}
\texttt{install.packages("tidyverse")}
\end{quote}

\bookmarksetup{startatroot}

\hypertarget{une-introduction-en-3-minutes}{%
\chapter{Une introduction en 3
minutes}\label{une-introduction-en-3-minutes}}

Le bloc de code ci-dessous combine tous les aspects que nous allons
aborder dans ce document : utilisation de packages, du pipe
\texttt{\%\textgreater{}\%}, préparation de données issues d'un tableau,
production et customisation d'un graphe, création d'une fonction,
calculs combinés sur listes de données, etc.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# dependencies}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# data tidying}
\NormalTok{iris2 }\OtherTok{\textless{}{-}}\NormalTok{ iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\AttributeTok{pl=}\NormalTok{Petal.Length, }\AttributeTok{pw=}\NormalTok{Petal.Width, }\AttributeTok{sp=}\NormalTok{Species)}
\NormalTok{iris2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 150 x 3
      pl    pw sp    
   <dbl> <dbl> <fct> 
 1   1.4   0.2 setosa
 2   1.4   0.2 setosa
 3   1.3   0.2 setosa
 4   1.5   0.2 setosa
 5   1.4   0.2 setosa
 6   1.7   0.4 setosa
 7   1.4   0.3 setosa
 8   1.5   0.2 setosa
 9   1.4   0.2 setosa
10   1.5   0.1 setosa
# i 140 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# a quick graph}
\FunctionTok{ggplot}\NormalTok{(iris2) }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp) }\SpecialCharTok{+} 
  \FunctionTok{geom\_jitter}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{scale\_color\_viridis\_d}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{colour=}\FunctionTok{guide\_legend}\NormalTok{(}\StringTok{"Species"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Petal length (mm)"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"Petal width (mm)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{3min-tour_files/figure-pdf/unnamed-chunk-1-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# a little helper function to get adjusted R2 of a linear model}
\NormalTok{lm\_adj\_r2 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(pl}\SpecialCharTok{\textasciitilde{}}\NormalTok{pw, }\AttributeTok{data=}\NormalTok{x))}\SpecialCharTok{$}\NormalTok{adj.r.squared}
  
\CommentTok{\# group{-}wise statistics}
\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{nest}\NormalTok{(}\AttributeTok{data=}\FunctionTok{c}\NormalTok{(pl, pw)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{adj\_r2=}\FunctionTok{map\_dbl}\NormalTok{(data, lm\_adj\_r2))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 3
  sp         data              adj_r2
  <fct>      <list>             <dbl>
1 setosa     <tibble [50 x 2]> 0.0914
2 versicolor <tibble [50 x 2]> 0.611 
3 virginica  <tibble [50 x 2]> 0.0851
\end{verbatim}

\bookmarksetup{startatroot}

\hypertarget{premiers-pas-et-concepts-cluxe9s}{%
\chapter{Premiers pas et
concepts-clés}\label{premiers-pas-et-concepts-cluxe9s}}

\hypertarget{arithmuxe9tique}{%
\section{Arithmétique}\label{arithmuxe9tique}}

En premier lieu, R est une calculette. Vous pouvez copier-coller les
blocs de code directement dans votre console R :

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# back to school}
\DecValTok{1}\SpecialCharTok{+}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

{[}1{]} 3

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{3{-}4}
\end{Highlighting}
\end{Shaded}

{[}1{]} -1

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{/}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

{[}1{]} 0.6666667

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{*}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

{[}1{]} 4

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# beyond +, {-}, /, *}
\DecValTok{2}\SpecialCharTok{\^{}}\DecValTok{4} 
\end{Highlighting}
\end{Shaded}

{[}1{]} 16

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sqrt}\NormalTok{(}\DecValTok{9}\NormalTok{) }\CommentTok{\# equivalent to 9\^{}(1/2)}
\end{Highlighting}
\end{Shaded}

{[}1{]} 3

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{7}\SpecialCharTok{\%\%}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

{[}1{]} 1

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# precedence rules apply}
\NormalTok{(}\FloatTok{1.5}\DecValTok{{-}2}\NormalTok{)}\SpecialCharTok{*}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

{[}1{]} -2

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{1.5}\DecValTok{{-}2}\SpecialCharTok{*}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

{[}1{]} -6.5

Tous les opérateurs arithmétiques courants sont disponibles :

\begin{itemize}
\tightlist
\item
  \texttt{+}, \texttt{-}, \texttt{*}, \texttt{/} pour l'arithmétique de
  base
\item
  \texttt{\^{}} pour élever au carré et \texttt{sqrt} pour la racine
  carrée
\item
  \texttt{\%\%} pour le
  \href{https://fr.wikipedia.org/wiki/Modulo_(opération)}{modulo}, etc.
\end{itemize}

Vous venez d'utiliser - peut-être sans le savoir -, votre première
fonction : \texttt{sqrt}, pour \emph{square root}. Les fonctions ont
souvent des noms explicites et sont, généralement, suivies de
parenthèses dans lesquelles glisser une ou des valeurs.

En réalité, toutes les opérations ci-dessus sont des fonctions, y
compris un banal \texttt{+}\footnote{essayez donc
  \texttt{\textasciigrave{}+\textasciigrave{}(1,\ 2)}}. Nous y
reviendrons mais cela nous vaut la première maxime de sagesse populaire
à garder dans un coin de la tête :

\begin{quote}
En R, tout est fonction.
\end{quote}

Vous pouvez également utiliser des parenthèses pour ``emboiter'' des
opérations dans le bon ordre. Sans parenthèses, les règles de
précédence\footnote{voir \texttt{?Syntax}} classiques s'appliquent comme
dans l'exemple ci-dessus : une multiplication sera calculée avant une
addition.

\hypertarget{variables-et-assignation}{%
\section{Variables et assignation}\label{variables-et-assignation}}

Comme on pouvait s'en douter, R a une mémoire et c'est donc plus qu'une
calculette, c'est une calculatrice.

Pour stocker une valeur dans une \textbf{variable} nous utilisons
l'opérateur d'\textbf{assignation} : \texttt{\textless{}-}\footnote{\texttt{\textasciigrave{}\textless{}-\textasciigrave{}(toto,\ 4);\ toto*2}
  puisqu'on te dit que tout est fonction !}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plop }\OtherTok{\textless{}{-}} \DecValTok{3}
\NormalTok{plop}\SpecialCharTok{\^{}}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 9
\end{verbatim}

D'autres opérateurs d'assignation existent (\texttt{-\textgreater{}},
\texttt{=}, \texttt{\textless{}\textless{}-}, etc.) mais je vous
conseille - calmement mais fermement - de vous en tenir au bon vieux
\texttt{\textless{}-}\footnote{L'assignation \texttt{-\textgreater{}}
  est acceptable dans certains contextes, notamment en combinaison avec
  un pipe \texttt{\%\textgreater{}\%}. \texttt{=} est plutôt réservés
  aux arguments de fonctions ou, éventuellement, à des méta-paramètres
  en début de script. \texttt{\textless{}\textless{}-} est en revanche
  proscrit car il assigne dans l'environnement global. Utilisé dans une
  fonction, il remplacera dans l'environnement global la valeur de cette
  variable, si elle existe. Si vous pensez en avoir besoin, c'est
  généralement (\textgreater99.9\%) que votre script/fonction est mal
  fichue.}.

Naturellement, si vous assignez une nouvelle valeur à une variable,
celle-ci est remplacée :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plop }\OtherTok{\textless{}{-}} \DecValTok{2}
\NormalTok{plop}\SpecialCharTok{+}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5
\end{verbatim}

Et bien entendu vous pouvez combiner les variables :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plip }\OtherTok{\textless{}{-}} \DecValTok{7}
\NormalTok{plop}\SpecialCharTok{*}\NormalTok{plip}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 14
\end{verbatim}

Vous pouvez lister les variables existantes avec la fonction
\texttt{ls()}. L'onglet ``Environnement'' dans RStudio permet aussi de
les visualiser, plus convivialement et de façon plus détaillée.

Pour afficher la valeur d'une variable, et plus généralement d'un objet,
il suffit de taper son nom dans la console et d'appuyer sur
\texttt{\textless{}Entrée\textgreater{}}. En coulisses, R appelle alors
automatiquement la fonction \texttt{print}.

R a tendance à faire beaucoup de choses en coulisses. Dans l'ensemble,
cela se traduit par un caractère raisonnablement intuitif pour vous.
Mais si une opération aussi naturelle qu'une assignation est une hérésie
majeure pour un esprit informaticien orthodoxe, habitué à déclarer une
variable et son type \emph{avant} d'y assigner une valeur.

\hypertarget{bien-nommer-ses-variables}{%
\section{Bien nommer ses variables}\label{bien-nommer-ses-variables}}

\begin{quote}
Mal nommer les choses c'est ajouter au malheur du monde -- Camus
\end{quote}

À propos du nommage de vos variables, soyez explicites mais compacts et
évitez : les caractères spéciaux, les majuscules, les points (utilisez
\texttt{\_}) et les noms réservés comme \texttt{pi}. Ici aussi,
l'anglais aide bien.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# good names}
\NormalTok{mod1}
\NormalTok{mod1\_spain}
\NormalTok{N\_perm}

\CommentTok{\# bad names}
\NormalTok{my.model }\CommentTok{\# . is for methods}
\NormalTok{MY\_MODEL }\CommentTok{\# calm down}
\NormalTok{My\_Model }\CommentTok{\# Camel Case works but not favoured}
\NormalTok{my\_model\_after\_lda\_a\_and\_data\_subset2\_flavourB }\CommentTok{\# headaches and typos garanteed}

\CommentTok{\# invalid or error{-}prone names}
\NormalTok{34\_data }
\NormalTok{pi }\OtherTok{\textless{}{-}} \DecValTok{4}    \CommentTok{\# works but very bad idea}
\NormalTok{print }\OtherTok{\textless{}{-}} \DecValTok{2} \CommentTok{\# same}
\SpecialCharTok{\&}\NormalTok{italy}
\end{Highlighting}
\end{Shaded}

Ce qui nous amène à une deuxième maxime populaire:

\begin{quote}
There are only two hard things in Computer Science: cache invalidation
and naming things. -- Phil Karlton
\end{quote}

Pour assigner plus d'une valeur à une variable, la fonction \texttt{c},
pour \emph{concatenate}, est votre amie :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\NormalTok{toto}\SpecialCharTok{*}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  2  4  6  8 10
\end{verbatim}

Jusqu'ici toutes les variables assignées étaient des scalaires, c'est à
dire des variables ne comprenant qu'une valeur. \texttt{toto} n'est pas
un scalaire mais un \emph{vecteur} de nombres, qui peut s'écrire en
ligne, c'est à dire en une seule et unique \emph{dimension}. Je pose ça
là, nous y reviendrons bien vite.

Quelques fonctions bien utiles pour visualiser et décrire des variables
en R :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(toto) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(toto, }\DecValTok{2}\NormalTok{) }\CommentTok{\# show the first 2 values}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(toto, }\DecValTok{3}\NormalTok{) }\CommentTok{\# show the last 3 values}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3 4 5
\end{verbatim}

Nous voyons que certaines fonctions acceptent plus d'une seule valeur au
sein de leurs parenthèses : on parle d'\textbf{argument}. Quand plus
d'un seul argument est \textbf{passé} à une fonction, on les sépare par
des virgules. Certaines fonctions peuvent/doivent aussi être appelées à
vide, comme on l'a vu avec \texttt{ls()}.

\hypertarget{suxe9quences-ruxe9guliuxe8res}{%
\section{Séquences régulières}\label{suxe9quences-ruxe9guliuxe8res}}

Vous m'avez vu (me) taper ``à la main'', des séries de nombres telles
que \texttt{c(1,\ 2,\ 3,\ 4,\ 5)}. Même l'esprit le plus endormi
constatera une certaine régularité dans cette séquence des premiers
entiers naturels. Jusqu'à 5, on peut imaginer - et encore -, la taper à
la main, mais imaginons que nous ayons besoin d'aller jusqu'à 100 ou
même à 37427. Doit bien y avoir quelqu'un·e qui a pensé à une fonction
pour faire ça non ? Ceci nous amène à une double maxime, peut-être les
deux plus importantes de toute cette formation.

\begin{quote}
Si tu penses que tu es en train de faire quelque chose de répétitif
et/ou stupide, il existe à coup sûr une façon plus intelligente de faire
\end{quote}

De façon plus compacte :

\begin{quote}
Un·e bon·ne programmeur·se est une grosse feignasse
\end{quote}

R possède toutes les fonctions dont on peut rêver pour générer séquences
régulières et nombres aléatoires. Commençons par les séquences
régulières et la versatile fonction \texttt{seq} qui prend au minimum
deux arguments pour le point de départ et le point d'arrivée :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

Générér une séquence d'entiers naturels est une opération si banale en
programmation que l'on peut faire encore pus court avec l'opérateur
\texttt{:}:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -1  0  1  2  3  4
\end{verbatim}

De la même façon, vous pouvez répéter une ou des valeurs avec
\texttt{rep} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tonton }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\FunctionTok{rep}\NormalTok{(tonton, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 1 2 3 4 5 1 2 3 4 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(tonton, }\AttributeTok{each=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 1 1 1 2 2 2 3 3 3 4 4 4 5 5 5
\end{verbatim}

À ce point de votre existence, vous devez vous poser les questions
suivantes :

\begin{itemize}
\tightlist
\item
  faut-il se rappeler de tout ça ?
\item
  ces histoires de paramètres de fonction, attends\ldots{} ah oui, le
  Monsieur a dit d'apeller ça des \emph{arguments}, c'est bien joli mais
  on les trouve où ?
\item
  et d'ailleurs il doit bien y avoir une documentation quelque part pour
  tout ce bazar ?
\item
  quand est-ce qu'on fait une pause ?
\end{itemize}

Vous vous posez les bonnes questions et il est temps de faire un
interlude, et non des moindres, l'interlude : \texttt{?}

\hypertarget{interlude-clavier}{%
\section{Interlude clavier}\label{interlude-clavier}}

\begin{itemize}
\tightlist
\item
  Toutes les commandes tapées depuis l'ouverture de R/RStudio sont dans
  votre console. Pour l'effacer, pressez
  \texttt{\textless{}Ctrl\textgreater{}\ +\ \textless{}L\textgreater{}}.
  Vos objets sont conservés.
\item
  Pour naviguer dans votre historique, côté console, pressez les flèches
  \texttt{\textless{}Haut\textgreater{}} et
  \texttt{\textless{}Bas\textgreater{}}.
\item
  Pour compléter un nom de fonction ou d'argument, pressez
  \texttt{\textless{}Tab\textgreater{}}
\item
  Une fois que vous avez la fonction qui vous intéresse,
  positionnez-vous au sein de ses parenthèses et pressez
  \texttt{\textless{}Tab\textgreater{}} de nouveau : la liste des
  arguments apparaît avec la portion de doc consacrée.
\item
  Dans RStudio, allez à peu près tout tester dans le menu \texttt{Code}.
  Vous y trouverez des fonctions très utiles (``Reindent lines'',
  ``Reformat code'' par exemple). À droite de la commande se trouve
  aussi les raccourcis clavier. Utilisez-les !
\end{itemize}

\hypertarget{fonctions}{%
\section{Fonctions}\label{fonctions}}

Les fonctions sont généralement abordées plus tard mais je crois non
seulement en vous mais aussi qu'elles doivent être démystifiées
précocément.

\hypertarget{que-sont-les-fonctions}{%
\subsection{Que sont les fonctions ?}\label{que-sont-les-fonctions}}

Les fonctions sont des unités de code qui font quelque chose d'utile. Le
plus souvent on envoie une valeur et on en récupère une autre.
\texttt{sqrt()} par exemple renvoie la racine carrée de la valeur
\emph{passée} en \emph{argument}.

Les arguments, séparés par des virgules, définissent les ``options'' de
la fonction concernée. Une fonction peut avoir zéro, un, plusieurs et
même un nombre indéfini d'argument.

\hypertarget{uxe9crire-ses-fonctions-function}{%
\subsection{\texorpdfstring{Écrire ses fonctions :
\texttt{function}}{Écrire ses fonctions : function}}\label{uxe9crire-ses-fonctions-function}}

Vous pouvez définir vos propres fonctions avec la fonction
\texttt{function}. On va encapsuler une portion de code entre des
accolades \texttt{\{} et la nommer. Définissons une fonction qui ajoute
\texttt{3} à un argument que l'on va appeller \texttt{x} (vous pouvez
essayer avec \texttt{y} ou \texttt{toto} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plus3 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  x}\SpecialCharTok{+}\DecValTok{3}
\NormalTok{\}}

\FunctionTok{plus3}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plus3}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4 5 6
\end{verbatim}

Les fonctions permettent de ne pas copier-coller bêtement du code, de
dupliquer des lignes. À terme, cela vous permettra d'avoir du code non
dupliqué, moins propice à des erreurs de frappes. Aussi, si vous changez
d'avis, vous pourrez changer la définition de fonction et, chaque fois
qu'elle sera appelée en aval, le nouveau comportement sera appliqué.
Nous reviendrons sur ces bonnes pratiques à la toute fin de cette
formation.

\hypertarget{notions-denvironnement}{%
\subsection{Notions d'environnement}\label{notions-denvironnement}}

La valeur \texttt{x} ci-dessus, dans la définition de fonction, est une
variable utilisée uniquement dans l'\textbf{environnement} de la
fonction \texttt{plus3}. Un environnement est un espace de travail
mémoire isolé du reste du monde et qui n'existe que durant l'exécution
de la fonction.

Autrement dit, si la variable \texttt{x} est déja assignée dans
l'\textbf{environnement global}, c'est à dire en dehors de la fonction,
dans la console si on veut, et bien ce \texttt{x} global ne sera ni
modifié, ni même utilisé. Un exemple :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{45}
\FunctionTok{plus3}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

Naturellement vous pouvez tout de même utiliser votre \texttt{x} global
comme argument de la fonction \texttt{plus3}. Ce \texttt{x} global va
être utilisé localement par la fonction puis vous être retourné :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plus3}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 48
\end{verbatim}

\hypertarget{documentation-des-fonctions}{%
\subsection{\texorpdfstring{Documentation des fonctions :
\texttt{?}}{Documentation des fonctions : ?}}\label{documentation-des-fonctions}}

Toute fonction déjà disponible en R ou un package a forcément une page
d'aide dédiée à laquelle on accède avec :
\texttt{?nom\_de\_la\_fonction}. Revenons à notre fonction \texttt{seq}
bien pratique pour créer des séquences régulières. En tapant
\texttt{?seq} on accède au contenu suivant :

\begin{verbatim}
Sequence Generation

Description
Generate regular sequences. seq is a standard generic with a default method. seq.int is a primitive which can be much faster but has a few restrictions. seq_along and seq_len are very fast primitives for two common cases.

## Default S3 method:
seq(from = 1, to = 1, by = ((to - from)/(length.out - 1)),
    length.out = NULL, along.with = NULL, ...)

seq.int(from, to, by, length.out, along.with, ...)

seq_along(along.with)
seq_len(length.out)

Arguments
[...]

Details
[...]

Value
[...]

See also
[...]

Examples
[...]
\end{verbatim}

Toutes les pages d'aides ont la même structure, et les sections
suivantes :

\begin{itemize}
\tightlist
\item
  \textbf{Description} : ce que la fonction fait
\item
  \textbf{Usage} : la fonction ``déployée'' c'est à dire avec tous ses
  arguments. Parfois plusieurs fonctions sont regroupées dans une même
  age d'aide, comme c'est le cas pour \texttt{seq}. Ces fonctions
  peuvent être des variantes avec des noms différents ou des
  \textbf{méthodes} c'est à dire des fonctions au comportement différent
  selon le type d'objet sur lequel elles opèrent.
\item
  \textbf{Arguments} : un descriptif de tous les arguments disponibles.
  La classe et le format de chacun d'eux est mentionnée.
\item
  \textbf{Details} : souvent un remède à l'insomnie mais les subtilités
  d'implémentation sont là, souvent cachées au détour d'une phrase.
\item
  \textbf{Value} : ce que la fonction retourne.
\item
  \textbf{References} : où s'en référer si vous n'en avez pas assez
\item
  \textbf{See Also} : fonctions connexes, très pratique pour enrichir
  son vocabulaire et trouver son bonheur.
\item
  \textbf{Examples} : peut être la plus utile de toutes avec ses
  exemples d'utilisation que vous pouvez copier-coller ou même appeller
  directement depuis la console avec
  \texttt{example("nom\_de\_la\_fonction")}. Vous pouvez essayer
  \texttt{example("plot")} par exemple.
\item
  En pied de page, vous avez également une information qui sera utile
  plus tard : le package et sa version dans lequel se trouve être cette
  fonction. Pour \texttt{seq}, on est dans le package \texttt{base} dont
  toutes les autres fonctions sont indexées dans le lien ``Index''.
\end{itemize}

Certaines pages d'aide, surtout pour le langage lui-même, sont plutôt
des résumés du fonctionnement et sont un peu moins intuitives à trouver,
par exemple \texttt{?Arithmetic}, \texttt{?Special}, \texttt{Syntax}.
D'autres fonctions, par exemple pour les opérateurs, doivent être
encadrées de guillemets arrières (\texttt{\textasciigrave{}}), par
exemple \texttt{?\textasciigrave{}+\textasciigrave{}} ou la mise en
abyme de \texttt{?\textasciigrave{}?\textasciigrave{}}. Enfin, il existe
d'autres ressources comme les ``vignettes'', plus conviviales, surtout
pour les packages les plus récents. Nous y reviendrons.

Les pages d'aide sont souvent compactes et obscures mais l'information
que vous cherchez est probablement là. On apprend beaucoup à lire ces
pages d'aide même si à première vue cette littérature n'est guère
attrayante.

Enfin, la variante \texttt{??(quoiquoiquoi)}, raccourci de
\texttt{help.search("quoiquoiquoi")} permet de chercher toutes les
occurences de \texttt{quoiquoiquoi} dans \emph{toutes} les pages d'aide
de R.

\hypertarget{arguments-noms-positions-et-valeurs-par-duxe9faut}{%
\subsection{Arguments : noms, positions et valeurs par
défaut}\label{arguments-noms-positions-et-valeurs-par-duxe9faut}}

Après avoir consulté \texttt{?seq} on peut par exemple préciser le point
de départ (\texttt{from}), le point d'arrivée (\texttt{to}), le pas
(\texttt{by}) et la longueur totale du vecteur à créer
(\texttt{length.out}).

Vous constaterez que \texttt{from} est défini avec une valeur par défaut
(\texttt{from=1}). Ainsi, si vous omettez sa valeur et ne spécifiez que
\texttt{to}, \texttt{from} prendra sa valeur par défaut. Ces deux
commandes sont donc équivalentes :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\AttributeTok{from=}\DecValTok{1}\NormalTok{, }\AttributeTok{to=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\AttributeTok{to=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4 5
\end{verbatim}

Vous pouvez également abréger le nom des arguments, moyennant que
l'abbréviation soit univoque, c'est à dire que le nom de l'argument que
vous abrégez ne soit pas identique à celui d'un autre argument. Ainsi
\texttt{from} et \texttt{length.out} peuvent être abrégés en \texttt{fr}
et \texttt{length}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\AttributeTok{fr=}\DecValTok{0}\NormalTok{, }\AttributeTok{to=}\DecValTok{2}\NormalTok{, }\AttributeTok{length=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.0 0.5 1.0 1.5 2.0
\end{verbatim}

Ce n'est jamais une bonne idée mais si vous utilisez le nom complet ou
une abbréviation des arguments vous pouvez changer leur ordre. Ainsi
\texttt{seq(length=5,\ to=2,\ fr=0)} sera équivalent à la commande
précédente.

Vous pouvez même omettre le nom des arguments comme on l'a fait dans les
sections précédentes sans le mentionner. Dans ce cas, les arguments sont
passés positionnellement et doivent être renseignés dans l'ordre tel que
défini dans la section `Usage' de leur documentation:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{12}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -3
\end{verbatim}

\hypertarget{concept-de-recyclage}{%
\section{Concept de recyclage}\label{concept-de-recyclage}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\NormalTok{toto}\SpecialCharTok{*}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  3  6  9 12 15
\end{verbatim}

Il n'aura pas échappé à votre sagacité que dans le précédent exemple, ou
une multiplicatio est opérée entre deux objets de tailles différentes
(cinq valeurs et une seule), R vous a compris et a multiplié
\emph{chaque} élément de \texttt{toto} par 3.

C'est l'idée, omniprésente, de \textbf{recyclage}. Ça ne parait pas
grand chose mais c'est souvent bien pratique et, hélas, quelques fois
glissant. Par exemple, si vous multipliez deux vecteurs non-conformes,
c'est à dire ni de même longueur, ni multiples l'un de l'autre, des
effets indésirables peuvent se manifester. Ou pire encore, rester
cachés.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{tata }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{toto}\SpecialCharTok{*}\NormalTok{tata}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning in toto * tata: longer object length is not a multiple of shorter object
length
\end{verbatim}

\begin{verbatim}
[1]  5  8  9 20
\end{verbatim}

De nos jours, R a tendance à émettre des Warnings quand un recyclage
exotique est impliqué. Lisez les messages et autres warnings ! Celui-ci
est plutôt explicite mais si vous n'y comprenez goutte, copiez-collez le
message dans un moteur de recherche.

\hypertarget{indexation-saisir-et-changer-des-valeurs}{%
\section{\texorpdfstring{Indexation \texttt{{[}} : saisir et changer des
valeurs}{Indexation {[} : saisir et changer des valeurs}}\label{indexation-saisir-et-changer-des-valeurs}}

Indexer une ou des valeurs c'est sélectionner un sous-ensemble de
valeurs dans une variable pour en faire quelque chose.

L'opérateur d'indexation est le crochet droit : \texttt{{[}}, qui tel
Dupont et Dupond vont par paires. À gauche du crochet, la variable; à
l'intérieur l'indice ou les indices.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{tutu[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\FunctionTok{length}\NormalTok{(tutu)] }\CommentTok{\# take the last value of tutu, no matter tutu\textquotesingle{} length}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12  5
\end{verbatim}

L'indexation peut se combiner avec l'assignation si on ne veut pas
seulement saisir les données mais en faire quelque chose :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  7 12  2  5  4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{)}
\NormalTok{tutu}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  7 -1 -3  5  4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}} \FloatTok{0.5}  \CommentTok{\# indexing, assignation and recycling combined!}
\NormalTok{tutu}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.0 0.5 0.5 5.0 4.0
\end{verbatim}

Ce type d'indexation est dit ``positive'' : l'indice réfère aux
positions que l'on \emph{veut}.

Bien pratique, l'opération d'indexation ``négative'' sélectionne ce que
l'on ne veut \emph{pas}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.0 0.5 0.5 5.0 4.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.5 0.5 5.0 4.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tutu[}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}}\NormalTok{ pi}
\NormalTok{tutu}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.000000 3.141593 0.500000 3.141593 3.141593
\end{verbatim}

Et comme vous vous en doutiez, on peut également utiliser une variable
pour indexer :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{tata }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{toto[tata]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto[}\SpecialCharTok{{-}}\NormalTok{tata]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6 3
\end{verbatim}

Le concept d'indexation est absolument central en R, et en programmation
en général.

L'indexation peut varier à la marge avec des indices dans plusieurs
dimensions comme nous le verrons plus loin (\texttt{iris{[}2,\ 3{]}}),
voire même des doubles crochets (\texttt{{[}{[}}), mais le comportement
présenté ici reste invariable. Youpi !

\hypertarget{opuxe9rateurs-de-comparaison-et-logiques}{%
\section{Opérateurs de comparaison et
logiques}\label{opuxe9rateurs-de-comparaison-et-logiques}}

L'indexation est une belle occasion de parler des opérateurs de
comparaison, très utiles pour filter vos données. L'idée est qu'on teste
d'abord une condition dont on peut se servir pour indexer

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tonton }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\NormalTok{test }\OtherTok{\textless{}{-}}\NormalTok{ tonton }\SpecialCharTok{\textless{}} \DecValTok{5}  \CommentTok{\# tests a condition}
\NormalTok{test}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  TRUE FALSE  TRUE FALSE  TRUE  TRUE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which}\NormalTok{(test) }\CommentTok{\# returns indices of TRUE}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 3 5 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# this can be used to index}
\NormalTok{tonton[}\FunctionTok{which}\NormalTok{(test)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4 2 1 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# or more directly}
\NormalTok{tonton[test] }\CommentTok{\# filter elements of tonton lower than 5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4 2 1 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# conditions can be combined}
\NormalTok{tonton[tonton }\SpecialCharTok{\textless{}} \DecValTok{5} \SpecialCharTok{\&}\NormalTok{ tonton }\SpecialCharTok{\textgreater{}=}\DecValTok{2}\NormalTok{] }\CommentTok{\# same with lower than 5 AND higher or equal to 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tata }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\SpecialCharTok{:}\DecValTok{1}\NormalTok{)}
\NormalTok{tonton[tata }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{)] }\CommentTok{\# takes the elements of tonton for which those of that are in 3:5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2 9 1
\end{verbatim}

Voilà une liste de tous les opérateurs de comparaison
(\texttt{?Comparison}) :

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
opérateur & signification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{\textless{}} & strictement inférieur \\
\texttt{\textless{}=} & inférieur ou égal \\
\texttt{\textgreater{}} & strictement supérieur \\
\texttt{\textgreater{}=} & supérieur ou égal \\
\texttt{==} & égal \\
\texttt{!=} & différent \\
\texttt{\%in\%} & dans l'ensemble \\
\end{longtable}

Et à y être celle pour les opérateurs logiques (\texttt{?Logic}) sur
lesquels nous reviendrons :

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
opérateur & signification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{!} & NOT \\
\texttt{\&} & AND (élément par élément) \\
\texttt{\&\&} & AND \\
\texttt{\textbar{}} & OR (élément par élément) \\
\texttt{\textbar{}\textbar{}} & OR \\
\texttt{xor(x,\ y)} & OR (exclusif) \\
\end{longtable}

Parfois on peut également avoir besoin de \texttt{any},
\texttt{all}\footnote{\texttt{\%notin\%} et \texttt{none} n'existent pas
  en R mais on peut facilement les composer avec
  \texttt{!(a\ \%in\%\ b)} et \texttt{!(all(...))}}.

\hypertarget{classes-dobjets}{%
\section{Classes d'objets}\label{classes-dobjets}}

\hypertarget{class}{%
\subsection{\texorpdfstring{\texttt{class}}{class}}\label{class}}

Accrochez-vous à votre voisin·e, nous abordons un concept clé. Jusqu'ici
nous n'avons manipulé que des nombres, avec ou sans assignation à une
variable. D'autres \textbf{classes} d'objets existent en R.

On peut accéder à la \textbf{classe} d'un vecteur avec la fonction
\texttt{class}. On voit que les chaînes de caractères sont des
\texttt{character} pour R:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(toto)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "numeric"
\end{verbatim}

Imaginons que nous mesurions des individus et que nous enregistrions
leurs prénoms, sexe, stature et si, oui ou non, ils ont subi une
formation à R. Ces quatres variables auront des natures différents :

\begin{itemize}
\tightlist
\item
  \texttt{prenom} : sera plutôt des lettres
\item
  \texttt{stature} : sera un nombre décrivant leur taille
\item
  \texttt{sexe} : sera une étiquette pouvant prendre une et une seule
  des valeurs suivantes \texttt{\{femme/homme/autre\}}
\item
  \texttt{formation} : sera un descripteur de type \texttt{vrai/faux}
  que l'on traduira en \texttt{TRUE/FALSE}.
\end{itemize}

Nous avons déja enregistré trois individus :

\begin{verbatim}
prenom        stature   genre     formation
Hildegarde    178       femme     TRUE
Jean-Jacques  163       homme     FALSE
Victor        184       autre     TRUE
\end{verbatim}

\hypertarget{character}{%
\subsection{\texorpdfstring{\texttt{character}}{character}}\label{character}}

Tentons de créer la première variable, c'est à dire la première colonne,
à la main :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prenom }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Hildegarde"}\NormalTok{, }\StringTok{"Jean{-}Jacques"}\NormalTok{, }\StringTok{"Victor"}\NormalTok{)}
\NormalTok{prenom}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Hildegarde"   "Jean-Jacques" "Victor"      
\end{verbatim}

R ne fait pas d'histoires et nous a crée un vecteur de chaînes de
caractères !

\hypertarget{numeric}{%
\subsection{\texorpdfstring{\texttt{numeric}}{numeric}}\label{numeric}}

Créons maintenant le vecteur \texttt{stature}, on sait faire :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stature }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{178}\NormalTok{, }\DecValTok{163}\NormalTok{, }\DecValTok{184}\NormalTok{)}
\NormalTok{stature}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 178 163 184
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(stature)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "numeric"
\end{verbatim}

Tous les vecteurs que nous avons crée jusqu'ici, \texttt{prenom} mis à
part, était donc des \texttt{numeric}. Précisions que des variantes de
\texttt{numeric} existent : \texttt{double}, \texttt{integer}, etc. mais
vous n'aurez peut être jamais à vous en soucier.

\hypertarget{factor}{%
\subsection{\texorpdfstring{\texttt{factor}}{factor}}\label{factor}}

La colonne \texttt{genre} est un peu particulière puisque elle est une
chaîne de caractères mais elle ne peut prendre que des valeurs définies,
à savoir une et une seule valeur de l'ensemble :
\texttt{\{homme,\ femme,\ autre\}}. La classe \texttt{factor} est là
pour ça et la fonction \texttt{factor} permet de créer notre variable
\texttt{sexe} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{genre }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"femme"}\NormalTok{, }\StringTok{"homme"}\NormalTok{, }\StringTok{"autre"}\NormalTok{))}
\FunctionTok{class}\NormalTok{(genre)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "factor"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{genre}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] femme homme autre
Levels: autre femme homme
\end{verbatim}

Votre œil aiguisé aura détecté deux différences par rapport à
\texttt{prenom} : l'absence de guillemets autour de chaque valeur et une
ligne supplémentaire qui indique les valeurs possibles, les
\texttt{levels} de ce vecteur.

Petite digression : les facteurs en R sont très pratiques mais assez
piégeux. Nous aurons l'occasion d'y revenir mais avant ça, évacuons les
dernier·e·s informaticien·ne·s pur sang de la salle. Imaginons qu'un
nouveau \texttt{level}, une nouvelle catégorie, doive être créée pour la
variable genre, disons \texttt{licorne}. Tentons l'opération candidement
:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{genre2 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(genre, }\StringTok{"licorne"}\NormalTok{)}
\NormalTok{genre2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "2"       "3"       "1"       "licorne"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(genre2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "character"
\end{verbatim}

Malédiction (apparente)\footnote{Il y a encore plus ``drôle'':
  \texttt{c(genre,\ 0)*2}} que nous expliquerons plus tard.

\hypertarget{logical}{%
\subsection{\texorpdfstring{\texttt{logical}}{logical}}\label{logical}}

Laissons reposer les facteurs pour l'instant et continuons notre
création de variable avec la colonne \texttt{formation}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{formation }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{class}\NormalTok{(formation)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "logical"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{formation}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  TRUE FALSE  TRUE
\end{verbatim}

Voici une classe très utile, les \texttt{logical}, souvent issus de
tests et de comparaisons logiques, comme survolé précédemmet par exemple
:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stature }\SpecialCharTok{\textgreater{}} \DecValTok{180}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE FALSE  TRUE
\end{verbatim}

Nous avons donc crée nos quatre colonnes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prenom}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Hildegarde"   "Jean-Jacques" "Victor"      
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stature}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 178 163 184
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{genre}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] femme homme autre
Levels: autre femme homme
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{formation}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  TRUE FALSE  TRUE
\end{verbatim}

Nous avons vu autant de classes différentes (\texttt{character},
\texttt{numeric}, \texttt{factor}, \texttt{logical} respectivement) et,
bonne nouvelle, on a quasiment fait le tour des classes ! Il nous en
reste deux, très voisines : \texttt{list} et \texttt{data.frame}.

\hypertarget{list}{%
\subsection{\texorpdfstring{\texttt{list}}{list}}\label{list}}

Une \texttt{list}e est un vecteur dont les éléments peuvent être de
classes et de longueurs différentes, dont d'autres listes. Autrement
dit, c'est la structure de données universelle en R :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{list}\NormalTok{(}\AttributeTok{toto=}\StringTok{"A"}\NormalTok{, }\AttributeTok{tata=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$toto
[1] "A"

$tata
[1] 1 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{list}\NormalTok{(prenom, stature)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[1]]
[1] "Hildegarde"   "Jean-Jacques" "Victor"      

[[2]]
[1] 178 163 184
\end{verbatim}

Vous pouvez comparer le résultat à \texttt{c(prenom,\ stature)}.
Observez aussi au passage les doubles crochets droits (\texttt{{[}{[}}),
dont vous n'aurez bien plus peur.

\hypertarget{data.frame}{%
\subsection{\texorpdfstring{\texttt{data.frame}}{data.frame}}\label{data.frame}}

Un type de liste bien pratique, devenu archi central en R moderne, est
le \texttt{data.frame} qui est une liste dont la double particularité
est que tous ses éléments sont nommés et de même longueur. Une façon un
peu alambiquée de dire qu'il nous aura fallu tout cela pour réinventer
en R le tableau excel !\footnote{Ne dites à personne que j'ai écrit ça !}.
Nous y reviendrons abondamment.

Comme vous pouvez vous en douter, personne n'importe les données comme
cela, on préférera lire directement une table \texttt{.csv} ou
\texttt{.xlsx}. Minute papillon, on y vient.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{prenom=}\NormalTok{prenom,}
                   \AttributeTok{stature=}\NormalTok{stature,}
                   \AttributeTok{genre=}\NormalTok{genre,}
                   \AttributeTok{formation=}\NormalTok{formation)}
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
        prenom stature genre formation
1   Hildegarde     178 femme      TRUE
2 Jean-Jacques     163 homme     FALSE
3       Victor     184 autre      TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "data.frame"
\end{verbatim}

\hypertarget{is.-et-as.}{%
\subsection{\texorpdfstring{\texttt{is.*} et
\texttt{as.*}}{is.* et as.*}}\label{is.-et-as.}}

Les fonctions \texttt{is.*} permettent de tester les classes :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.logical}\NormalTok{(formation)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.factor}\NormalTok{(prenom)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.data.frame}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

Et les fonctions \texttt{as.*} permettent de convertir les classes,
lorsque la conversion est pertinente :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.factor}\NormalTok{(prenom)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] Hildegarde   Jean-Jacques Victor      
Levels: Hildegarde Jean-Jacques Victor
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.character}\NormalTok{(genre)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "femme" "homme" "autre"
\end{verbatim}

\hypertarget{indexation-multiple}{%
\section{\texorpdfstring{Indexation multiple
\texttt{{[},}}{Indexation multiple {[},}}\label{indexation-multiple}}

Revenons à notre \texttt{data.frame} \texttt{data}, un objet en deux
dimensions : il possède des lignes et des colonnes. L'indexation vue
précédemment sur des vecteurs, des objets en une seule dimension,
fonctionne dans le même esprit mais il nous faut renseigner les indices
pour chaque dimension. Si l'un des indices n'est pas renseigné, toutes
les positions concernées sont retournées mais il ne faut pas oublier
pour autant la virgule !

Par convention la première dimension est celle des lignes, la deuxième
celle des colonnes. Quelques exemples ci-dessous qui ne font qu'extraire
les données. Nous pourrions aussi les modifier avec l'opérateur
d'assignation \texttt{\textless{}-} comme vu précédemment.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[}\DecValTok{1}\NormalTok{, ] }\CommentTok{\# first row}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      prenom stature genre formation
1 Hildegarde     178 femme      TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[, }\DecValTok{1}\NormalTok{] }\CommentTok{\# first column}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Hildegarde"   "Jean-Jacques" "Victor"      
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, ] }\CommentTok{\# everything but the second row}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      prenom stature genre formation
1 Hildegarde     178 femme      TRUE
3     Victor     184 autre      TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{), }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{] }\CommentTok{\# first and third row, all columns but the third}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      prenom stature formation
1 Hildegarde     178      TRUE
3     Victor     184      TRUE
\end{verbatim}

Vous aurez noté qu'en ne sélectionnant qu'une colonne, par exemple
\texttt{data{[},\ 1{]}} ci-dessus, on perd la nature de
\texttt{data.frame} pour revenir à la classe d'origine de la colonne.
Souvent pratique, parfois glissant. Pour ne pas perdre la classe
d'origine, il suffit d'ajouter \texttt{drop=FALSE} à votre opération
d'indexation, après tous les indices :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[, }\DecValTok{2}\NormalTok{, drop}\OtherTok{=}\ConstantTok{FALSE}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  stature
1     178
2     163
3     184
\end{verbatim}

Les colonnes uniques peuvent aussi se sélectionner avec l'opérateur
\texttt{\$} qui permet d'accéder à un élément de liste, pourvu qu'il
soit nommé. Les \texttt{data.frame}s étant des listes nommées, cela
fonctionne :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\SpecialCharTok{$}\NormalTok{stature}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 178 163 184
\end{verbatim}

Les doubles crochets droits \texttt{{[}{[}} permettent eux aussi de
sélectionner positionnellement, ou nominativement, l'élément de liste
concerné. Les deux commandes ci-dessous seront équivalentes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[[}\DecValTok{3}\NormalTok{]]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] femme homme autre
Levels: autre femme homme
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data[[}\StringTok{"genre"}\NormalTok{]]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] femme homme autre
Levels: autre femme homme
\end{verbatim}

\hypertarget{indexation-de-liste-versus}{%
\section{\texorpdfstring{Indexation de liste : \texttt{{[}} versus
\texttt{{[}{[}}}{Indexation de liste : {[} versus {[}{[}}}\label{indexation-de-liste-versus}}

L'indexation avec une simple ou une double paire de crochets est souvent
source d'incompréhension d'autant que sur des vecteurs le résultat est
le même :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto }\OtherTok{\textless{}{-}} \DecValTok{5}\SpecialCharTok{:}\DecValTok{3}
\NormalTok{toto}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5 4 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto[[}\DecValTok{2}\NormalTok{]]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

Gardez à l'esprit que la double paire de crochets droits
(\texttt{{[}{[}}) ne s'utilise que sur des listes (\texttt{data.frame} y
compris donc).

Pour expliquer simplement la différence entre \texttt{{[}} et
\texttt{{[}{[}}, disons qu'une liste est un train de marchandise sans
locomotive avec un ou plusieurs wagons.

\begin{itemize}
\tightlist
\item
  \texttt{{[}} permet de sélectionner un wagon, le résultat est toujours
  un train, certes minima\textbf{liste}
\item
  \texttt{{[}{[}} permet de sélectionner le \textbf{contenu} du wagon
  qui n'est donc plus un train mais une vache, une palette ou des
  voyageurs :
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tata }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{wagon1=}\StringTok{"a"}\NormalTok{, }\AttributeTok{wagon2=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\CommentTok{\# [ picks a list element}
\NormalTok{tata[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$wagon2
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(tata[}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "list"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# [[ picks a list element AND drops the list}
\NormalTok{tata[[}\DecValTok{2}\NormalTok{]]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(tata[[}\DecValTok{2}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "integer"
\end{verbatim}

Notons que \texttt{\$} est équivalent à \texttt{{[}{[}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tata}\SpecialCharTok{$}\NormalTok{wagon2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3
\end{verbatim}

\hypertarget{matrix}{%
\section{\texorpdfstring{\texttt{matrix}}{matrix}}\label{matrix}}

Par souci de complétude, mentionnons les matrices qui sont des tableaux
rectangulaires de nombres. Elles se créent avec la fonction
\texttt{matrix} et en spécifiant les valeurs de remplissage et le nombre
de lignes et/ou de colonnes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{9.2}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{0}\NormalTok{), }\AttributeTok{nrow=}\DecValTok{2}\NormalTok{)}
\NormalTok{m}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     [,1] [,2] [,3]
[1,]    3  9.2    7
[2,]    1  6.0    0
\end{verbatim}

Les \texttt{matrix} et les \texttt{data.frame} possèdent de nombreux
points communs. On peut notamment accéder à leurs dimensions, noms de
lignes et colonnes avec les mêmes fonctions :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ncol}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rownames}\NormalTok{(m) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"plop"}\NormalTok{, }\StringTok{"plip"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(m) }\CommentTok{\# idem for colnames}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "plop" "plip"
\end{verbatim}

Une opération courante sur des matrices consiste à faire des calculs
marginaux, par exemple calculer la somme par colonnes. La famille
\texttt{apply} permet ce type de calcul. On va renseigner trois
arguments (voir \texttt{?apply} et ses exemples) : l'objet sur lequel
travailler; la dimension sur laquelle calculer (\texttt{1} pour les
lignes, \texttt{2} pour les colonnes); et enfin la fonction à appliquer,
sans parenthèses :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{apply}\NormalTok{(m, }\DecValTok{2}\NormalTok{, sum)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  4.0 15.2  7.0
\end{verbatim}

\hypertarget{array}{%
\section{\texorpdfstring{\texttt{array}}{array}}\label{array}}

Par souci de complétude, l'idée de matrice se généralise dans des
dimensions supérieures à 2. Pour le dire autrement, une \texttt{matrix}
est un \texttt{array} à deux dimensions.

Les \texttt{array} se créent dans le même esprit : les valeurs de
remplissage d'abord, puis on précise les dimensions. Ci-dessous, un
array de deux tranches de matrices de \texttt{2x3}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}\AttributeTok{data=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{12}\NormalTok{), }\AttributeTok{dim=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\NormalTok{a}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
, , 1

     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

, , 2

     [,1] [,2] [,3]
[1,]    7    9   11
[2,]    8   10   12
\end{verbatim}

L'indexation fonctionne ici aussi. Par exemple si l'on veut la valeur de
la première ligne, troisième colonne, deuxième tranche :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a[}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 11
\end{verbatim}

\hypertarget{fonctions-utiles}{%
\section{Fonctions utiles}\label{fonctions-utiles}}

\hypertarget{sur-numeric}{%
\subsection{\texorpdfstring{Sur
\texttt{numeric}}{Sur numeric}}\label{sur-numeric}}

Quelques fonctions utiles pour décrire des vecteurs numériques
(\texttt{numeric}) :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\FunctionTok{length}\NormalTok{(x) }
\FunctionTok{min}\NormalTok{(x)}
\FunctionTok{max}\NormalTok{(x)}
\FunctionTok{range}\NormalTok{(x)  }\CommentTok{\# shortcut for c(min(x), max(x))}
\FunctionTok{median}\NormalTok{(x) }\CommentTok{\# shortcut for quantile(x, probs=0.5)}
\FunctionTok{sum}\NormalTok{(x)}
\FunctionTok{mean}\NormalTok{(x)   }\CommentTok{\# average}
\FunctionTok{sd}\NormalTok{(x)     }\CommentTok{\# standard deviation}
\FunctionTok{var}\NormalTok{(x)    }\CommentTok{\# variance}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5
[1] 1
[1] 5
[1] 1 5
[1] 3
[1] 15
[1] 3
[1] 1.581139
[1] 2.5
\end{verbatim}

\hypertarget{sur-factor}{%
\subsection{\texorpdfstring{Sur
\texttt{factor}}{Sur factor}}\label{sur-factor}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f1 }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"apple"}\NormalTok{, }\StringTok{"banana"}\NormalTok{, }\StringTok{"banana"}\NormalTok{, }\StringTok{"pear"}\NormalTok{, }\StringTok{"grape"}\NormalTok{, }\StringTok{"grape"}\NormalTok{))}
\NormalTok{f2 }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"yellow"}\NormalTok{, }\StringTok{"yellow"}\NormalTok{, }\StringTok{"yellow"}\NormalTok{, }\StringTok{"green"}\NormalTok{, }\StringTok{"red"}\NormalTok{, }\StringTok{"green"}\NormalTok{))}

\FunctionTok{length}\NormalTok{(f1)  }\CommentTok{\# length}
\FunctionTok{levels}\NormalTok{(f1)  }\CommentTok{\# levels, as character}
\FunctionTok{nlevels}\NormalTok{(f1) }\CommentTok{\# number of levels, shortcut for length(level(f1))}
\FunctionTok{table}\NormalTok{(f1)   }\CommentTok{\# count occurences}
\FunctionTok{table}\NormalTok{(f1, f2) }\CommentTok{\# cross{-}tabulate factors}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6
[1] "apple"  "banana" "grape"  "pear"  
[1] 4
f1
 apple banana  grape   pear 
     1      2      2      1 
        f2
f1       green red yellow
  apple      0   0      1
  banana     0   0      2
  grape      1   1      0
  pear       1   0      0
\end{verbatim}

\hypertarget{sur-character}{%
\subsection{\texorpdfstring{Sur
\texttt{character}}{Sur character}}\label{sur-character}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bla1 }\OtherTok{\textless{}{-}} \StringTok{"tonton"}
\NormalTok{bla2 }\OtherTok{\textless{}{-}} \StringTok{"tata"}

\FunctionTok{nchar}\NormalTok{(bla1) }\CommentTok{\# count characters}
\FunctionTok{paste}\NormalTok{(bla1, bla2, }\AttributeTok{sep=}\StringTok{" et "}\NormalTok{) }\CommentTok{\# see also paste0}
\FunctionTok{toupper}\NormalTok{(bla1) }\CommentTok{\# convert to upper case. see also tolower()}
\FunctionTok{gsub}\NormalTok{(}\StringTok{"o"}\NormalTok{, }\StringTok{"i"}\NormalTok{, bla1) }\CommentTok{\# replace all \textquotesingle{}o\textquotesingle{} with \textquotesingle{}i\textquotesingle{} in bla1. see ?grep}
\FunctionTok{substr}\NormalTok{(bla1, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{) }\CommentTok{\# character from positions 2 to 4}
\FunctionTok{abbreviate}\NormalTok{(bla1) }\CommentTok{\# abbreviate}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6
[1] "tonton et tata"
[1] "TONTON"
[1] "tintin"
[1] "ont"
tonton 
"tntn" 
\end{verbatim}

Les derniers exemples montrent des manipulations de chaînes de
caractères. Le package \texttt{stringr} remplace avantageusement ces
approches ``historiques''. Nous y reviendrons.

\hypertarget{sur-data.frame}{%
\subsection{\texorpdfstring{Sur
\texttt{data.frame}}{Sur data.frame}}\label{sur-data.frame}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(data)}
\FunctionTok{nrow}\NormalTok{(data)}
\FunctionTok{ncol}\NormalTok{(data) }\CommentTok{\# equivalent to length(data)}
\FunctionTok{summary}\NormalTok{(data) }\CommentTok{\# a summary, column{-}wise}
\FunctionTok{head}\NormalTok{(data) }\CommentTok{\# show only the first rows}
\FunctionTok{tail}\NormalTok{(data) }\CommentTok{\# show only the last rows}
\CommentTok{\# View(data) \# show an interactive viewer for your data.frame}
\FunctionTok{str}\NormalTok{(data)  }\CommentTok{\# show the structure of your data.frame}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3 4
[1] 3
[1] 4
    prenom             stature        genre   formation      
 Length:3           Min.   :163.0   autre:1   Mode :logical  
 Class :character   1st Qu.:170.5   femme:1   FALSE:1        
 Mode  :character   Median :178.0   homme:1   TRUE :2        
                    Mean   :175.0                            
                    3rd Qu.:181.0                            
                    Max.   :184.0                            
        prenom stature genre formation
1   Hildegarde     178 femme      TRUE
2 Jean-Jacques     163 homme     FALSE
3       Victor     184 autre      TRUE
        prenom stature genre formation
1   Hildegarde     178 femme      TRUE
2 Jean-Jacques     163 homme     FALSE
3       Victor     184 autre      TRUE
'data.frame':   3 obs. of  4 variables:
 $ prenom   : chr  "Hildegarde" "Jean-Jacques" "Victor"
 $ stature  : num  178 163 184
 $ genre    : Factor w/ 3 levels "autre","femme",..: 2 3 1
 $ formation: logi  TRUE FALSE TRUE
\end{verbatim}

graphics:::plot.data.frame

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2329}\NormalTok{)}
\FunctionTok{runif}\NormalTok{(}\DecValTok{10}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  0.34341687 -0.89818619  0.86519883  0.05414381 -0.95204424  0.42169961
 [7]  0.09957463  0.27190793 -0.84168929  0.72023581
\end{verbatim}

\hypertarget{guxe9nuxe9rer-des-nombres-aluxe9atoires}{%
\section{Générer des nombres
aléatoires}\label{guxe9nuxe9rer-des-nombres-aluxe9atoires}}

\hypertarget{au-sein-dune-suxe9quence-existante}{%
\subsection{Au sein d'une séquence
existante}\label{au-sein-dune-suxe9quence-existante}}

La fonction \texttt{sample} permet d'échantillonner au sein d'un vecteur
existant. Vous devenz préciser ce vecteur, puis le nombre de tirages à
effectuer, avec ou sans remise.

Si vous n'avez pas de dé, en voilà un :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{, }\AttributeTok{size=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6
\end{verbatim}

Avec \texttt{size=3,\ replace=TRUE} vous pouvez même jouer au 421. Ou
encore générer un tirage de loto sans les boules qui s'agitent :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{49}\NormalTok{, }\AttributeTok{size=}\DecValTok{6}\NormalTok{, }\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  9 47 36 14  4 34
\end{verbatim}

Chaque élément du vecteur a autant de chance de sortir qu'un autre. Si
vous préférez le scrabble, vous pouvez aussi utiliser \texttt{sample}
mais en calibrant l'argument \texttt{probs} sur la fréquence des lettres
dans la langue française. N'allez donc pas vous taper l'alphabet à la
main, jeter un oeil à \texttt{letters} et \texttt{LETTERS}.

\hypertarget{distributions-existantes}{%
\subsection{Distributions existantes}\label{distributions-existantes}}

Au delà des vecteurs existants, vous pouvez générer des nombres
aléatoires issus d'une distribution. Toutes les distributions
disponibles sont listées dans la bien nommée \texttt{?Distriutions}.

Ces fonctions sont nommées de la façon suivante
\texttt{\{r,\ p,\ q,\ d\}nom\_abregé\_distrib}. La première lettre
désigne la variante désirée des différentes fonctions pour une
distribution donnée, selon que l'on veuille générer des nombres, la
densité de probabilité, les quantiles associés, etc.

Pour générer 10 nombres aléatoires compris entre -1 et 1 on peut par
exemple :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{runif}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) }\CommentTok{\# see ?runif}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 0.1193610 0.4918118 0.7741212 0.3069952 0.7218488 0.4027434 0.4372506
 [8] 0.8760479 0.8498670 0.4134920
\end{verbatim}

Dans le même esprit on peut tirer 1000 nombres issus d'une distribution
normale de moyenne 5 et d'écart-type 3 avec la commande suivante :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\FloatTok{1e3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.028203
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3.014893
\end{verbatim}

\texttt{1e3} est la notation dite ``ingénieur'' parfaitement comprise
par R. Ici, on a 1 suivi de 3 zéros, soit \texttt{10\^{}3} soit
\texttt{1000}. Vous constaterez également que la moyenne est à peu près
de 5 et l'écart type à peu près égal à 3.

Si vous réexécutez cette commande, vous aurez un autre vecteur avec des
valeurs différentes mais également à peu près centré sur 5.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\FloatTok{1e3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(x) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -0.01312834
\end{verbatim}

Si vous désirez générer des nombres aléatoires certes, mais les mêmes,
par exemple d'une session à l'autre ou (c'est la même chose) sur
l'ordinateur de votre collègue, c'est possible avec la fonction
\texttt{set.seed}.

\hypertarget{premiers-graphes}{%
\section{Premiers graphes}\label{premiers-graphes}}

Décrire un vecteur de nombres avec \texttt{mean} et \texttt{sd} mais
faire des jolis graphes c'est mieux. La commande \texttt{plot} est la
fonction de base pour ce faire :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-59-1.pdf}

}

\end{figure}

R a compris que chaque valeur du vecteur \texttt{x} devait être plottée
sur l'axe de ordonnées et en a déduit que l'axe des abscisses devait
être la série de 1 à 1000. Ici un histogramme serait plus approprié pour
décrire la distribution de notre vecteur de nombres aléatoires :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-60-1.pdf}

}

\end{figure}

On voit qu'il est bien centré sur \texttt{5}. Si l'on augmente le nombre
de valeurs générées ainsi que le nombres d'intervalles (\texttt{breaks}
en anglais), on retrouve une bien belle gaussienne :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\FloatTok{1e5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{3}\NormalTok{), }\AttributeTok{breaks=}\DecValTok{50}\NormalTok{, }\AttributeTok{main=}\StringTok{"Un histogramme"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-61-1.pdf}

}

\end{figure}

Les graphiques de base de R sont un peu surannés depuis l'avènement de
\texttt{gpplot2} que nous verrons en détail plus loin mais ils ont
encore leur mot à dire, même s'il ne s'exprimeront pas longuement ici.

Voyons tout de même ce que l'on peut faire avec \texttt{iris}, l'un des
nombreux jeux de données livrés avec R\footnote{voir \texttt{?datasets}.}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Petal.Length}\SpecialCharTok{\textasciitilde{}}\NormalTok{Petal.Width, }\AttributeTok{data=}\NormalTok{iris, }\AttributeTok{col=}\NormalTok{Species,}
     \AttributeTok{xlab=}\StringTok{"Largeur de pétale (cm)"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Longueur de pétale (cm)"}\NormalTok{,}
     \AttributeTok{main=}\StringTok{"Les fameux iris de Fisher (voire d\textquotesingle{}Anderson)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-62-1.pdf}

}

\end{figure}

En petit aguichage \texttt{ggplot2} voilà ce qu'on peut obtenir dans le
même temps :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{ggplot}\NormalTok{(iris) }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Petal.Width, }\AttributeTok{y=}\NormalTok{Petal.Length, }\AttributeTok{col=}\NormalTok{Species) }\SpecialCharTok{+} 
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Species) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Largeur de pétale (cm)"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Longueur de pétale (cm)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Les fameux iris de Fisher (voire d\textquotesingle{}Anderson)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_linedraw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-63-1.pdf}

}

\end{figure}

\hypertarget{un-mot-sur-les-packages}{%
\section{Un mot sur les packages}\label{un-mot-sur-les-packages}}

\hypertarget{lopuxe9rateur-pipe}{%
\section{\texorpdfstring{L'opérateur \emph{pipe}
\texttt{\%\textgreater{}\%}}{L'opérateur pipe \%\textgreater\%}}\label{lopuxe9rateur-pipe}}

Il est peu dire que cet opérateur\footnote{À prononcer à l'anglaise hein
  : ``payepeu''} a révolutionné R, lorsqu'il y a été importé, d'abord
dans le package \texttt{magrittr} sous sa forme
\texttt{\%\textgreater{}\%}. Il est désormais inclus dans le R de
``base'' sous sa forme \texttt{\textbar{}\textgreater{}} mais nous
n'utiliserons que la version historique \texttt{\%\textgreater{}\%}, que
je trouve plus lisible, plus facile à taper
(\texttt{\textless{}Maj\textgreater{}\ +\ \textless{}Ctrl/Cmd\textgreater{}\ +\ \textless{}M\textgreater{}}
dans RStudio) et parce que les années aidant, je deviens conservateur.

L'idée du pipe est issue de la composition de fonctions en
mathématiques. Plutôt que d'écrire :

\texttt{h(g(f(x)))} on peut déplier cet emboitement de fonctions et
écrire \texttt{(h\ ∘\ g\ ∘\ f)(x)}

En langage R, plutôt que d'écrire \texttt{h(g(f(x)))} on écrira :
\texttt{x\ \%\textgreater{}\%\ f()\ \%\textgreater{}\%\ g()\ \%\textgreater{}\%\ h()}\footnote{Vous
  pouvez également omettre les parenthèses si vos fonctions sont passées
  sans argument.}. Cette écriture est non seulement plus lisible mais
elle se lit également de gauche à droite, dans le sens conventionnel de
notre partie du monde.

Comparez ces deux lignes pourtant strictement équivalentes:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{sample}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{), }\DecValTok{6}\NormalTok{)))              }\CommentTok{\# road to burnout}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-65-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{sample}\NormalTok{(}\DecValTok{6}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{sqrt}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{plot}\NormalTok{() }\CommentTok{\# let\textquotesingle{}s breathe}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{premiers-pas_files/figure-pdf/unnamed-chunk-65-2.pdf}

}

\end{figure}

Les packages du R moderne, en premier lieu ceux du \texttt{tidyverse} en
ont fait une idée centrale de leur design et il est peu dire que nous
autres mortel·le·s en profitons tous les jours.

\hypertarget{trucs-et-astuces-pour-r-et-rstudio}{%
\section{Trucs et astuces pour R et
RStudio}\label{trucs-et-astuces-pour-r-et-rstudio}}

\begin{itemize}
\tightlist
\item
  Toutes les commandes tapées depuis l'ouverture de R/RStudio sont dans
  votre console. Pour l'effacer, pressez
  \texttt{\textless{}Ctrl\textgreater{}\ +\ \textless{}L\textgreater{}}.
  Vos objets sont conservés.
\item
  Pour naviguer dans votre historique, côté console, pressez les flèches
  \texttt{\textless{}Haut\textgreater{}} et
  \texttt{\textless{}Bas\textgreater{}}.
\item
  Pour compléter un nom de fonction ou d'argument, pressez
  \texttt{\textless{}Tab\textgreater{}}
\end{itemize}

Le flux classique de travail est le suivant :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Vous voulez faire quelque chose
\item
  Vous bidouillez dans la console
\item
  Vous êtes satisfait·e de votre commande
\item
  Vous la sauvez dans un script
\item
  Repartez à 1.
\end{enumerate}

Au fur et à mesure de votre avancée, votre script va se remplir. Demain,
dans 6 mois, ou sur un autre ordinateur, vous pourrez refaire
``tourner'' vos analyses et avoir strictement les mêmes résultats. On
parle de \textbf{reproductibilité}. Gage de science sérieuse et, pour
vous, de sérenité. Pour ces raisons, je vous conseille de ne pas
enregistrer votre environnement de travail quand vous fermez R ou
RStudio.

Un script peut être un fichier texte ou \texttt{.R}. RStudio gère bien
les différents scripts en affichant dans la même fenêtre votre console,
vos scripts, vos graphes, etc.

\begin{itemize}
\tightlist
\item
  De temps à autre, faites tout ``retourner''. RStudio a un raccourci
  pour cela : \texttt{Run\ \textgreater{}\ Restart\ R\ and\ run\ all}.
\item
  Vous pouvez également faire tourner un autre script depuis le script
  en cours avant \texttt{source}. Bien pratique par exemple pour mettre
  toutes vos fonctions dans un script et les analyses à proprement
  parler dans un autre.
\end{itemize}

RStudio a pléthore raccourcis et fonctionnalités bien pratiques par
exemple pour formater votre code selon les standards en cours
(\texttt{Code\ \textgreater{}\ Reformat\ Code}) ou simplement pour
réindenter proprement votre code. L'indentation est le décalage par
rapport à la marge gauche du script. Cette indentation est purement
esthétique en R, contrairement à Python par exemple. Elle est bien
pratique pour sauter une ligne qui serait trop longue, ce qui est
déconseillé.

\hypertarget{pour-la-suite}{%
\section{Pour la suite}\label{pour-la-suite}}

Si vous lisez ces lignes c'est que vous avez survécu jusqu'ici, bravo.
Vous avez fait le plus dur, vous parlez déjà R. Le reste est une longue
promenade en faux plat qui tourne autour de ces idées. Bien sûr, votre
vocabulaire va s'enrichir, votre syntaxe sera de plus en plus concise et
vous passerez ainsi de plus en plus de temps à la plage.

Bien sûr, vous aurez envie de mettre le feu à l'ordinateur, votre bureau
et l'intégralité du monde open-source. N'en faites rien, asseyez vous en
tailleur et méditez la sentence de notre maitre à tou·te·s, Hadley
Wickham :

\begin{quote}
Frustration is typical and temporary
\end{quote}

L'échec, l'incompréhension, la frustration sont la matérialisation de
l'apprentissage. Restez calmes, gardez votre sang-froid, tapez votre
problème dans Google, lisez Stack Overflow et faites vous confiance.
Perséverez. Je crois en vous.

\bookmarksetup{startatroot}

\hypertarget{uxe9luxe9ments-de-programmation}{%
\chapter{Éléments de
programmation}\label{uxe9luxe9ments-de-programmation}}

\hypertarget{control-flow}{%
\section{Control flow}\label{control-flow}}

Faisons comme Houellebecq et pompons
\href{https://fr.wikipedia.org/wiki/Structure_de_contr\%C3\%B4le}{Wikipédia}
qui écrit mieux que nous :

\begin{quote}
En programmation informatique, une structure de contrôle est une
instruction particulière d'un langage de programmation impératif pouvant
dévier le flot de contrôle du programme la contenant lorsqu'elle est
exécutée. Si, au plus bas niveau, l'éventail se limite généralement aux
branchements et aux appels de sous-programme, les langages structurés
offrent des constructions plus élaborées comme les alternatives (if,
if--else, switch\ldots), les boucles (while, do--while, for\ldots) ou
encore les appels de fonction.
\end{quote}

\texttt{if}, \texttt{else}, \texttt{ifelse}, \texttt{for},
\texttt{while}, \texttt{next}, \texttt{break}

En termes plus directs, le \emph{control flow} dont disposent à peu près
tous les langages de programmation, permet d'adapter le comportement
d'un code en fonction des circonstances.

\hypertarget{if}{%
\section{\texorpdfstring{\texttt{if}}{if}}\label{if}}

Imaginons par exemple que nous voulions écrire une fonction qui imprime
à la console si un nombre est positif ou négatif. La structure
\texttt{if} permet de tester une condition logique et, généralement,
d'agir en conséquence. \texttt{?Control} nous apprend que son patron
général est le suivant :

\begin{verbatim}
if (condition) expr
\end{verbatim}

\texttt{condition} sera un test logique qui, s'il est vrai, exécutera la
ou les commandes \texttt{expr}. Si la commande est unique vous pouvez
l'écrire en ligne. Si elle est multiple, on l'embrassera d'accolades :

\begin{verbatim}
if (condition) {
expr1
expr2
etc.
}
\end{verbatim}

Notre fonction pourrait ressembler à :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{signe1 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
  \ControlFlowTok{if}\NormalTok{ (x }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(x, }\StringTok{"est positif"}\NormalTok{)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{ (x }\SpecialCharTok{\textless{}} \DecValTok{0}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(x, }\StringTok{"est négatif"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}

\FunctionTok{signe1}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
-1 est négatif
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe1}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
5 est positif
\end{verbatim}

Ici, nous omettons le classique \texttt{return} car la fonction ne
retourne rien, elle se contente d'émettre un message dans la console
avec \texttt{cat()} ce qui est très différent. Du reste, vous pouvez
presque toujours omettre \texttt{return} car une fonction retourne
simplement la dernière valeur de son code. Ci-dessous, \texttt{signe1()}
ne retourne rien car \texttt{toto} est \texttt{NULL} (sauf si vous
l'avez assigné avant naturellement).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto }\OtherTok{\textless{}{-}} \FunctionTok{signe1}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
1 est positif
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toto}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
NULL
\end{verbatim}

\hypertarget{else}{%
\section{\texorpdfstring{\texttt{else}}{else}}\label{else}}

Plutôt que d'empiler les \texttt{if}, vous pouvez utiliser \texttt{else}
quand si ce n'est pas un cas, c'est forcément l'autre. Comme cela (à
première vue) semble être le cas ici :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{signe2 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
  \ControlFlowTok{if}\NormalTok{ (x }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(x, }\StringTok{"est positif"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(x, }\StringTok{"est négatif"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}

\FunctionTok{signe2}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
-1 est négatif
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe2}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
5 est positif
\end{verbatim}

En réalité ici, on a une complication supplémentaire quand \texttt{x=0},
que n'est pas prévu par \texttt{signe1} et pire encore par
\texttt{signe2} (essayez donc \texttt{signe1(0)} et \texttt{signe2(0)}).
Les \texttt{if/else} peuvent être emboités et l'indentation de code se
révèle particulièrement utile.
(\texttt{Code\ \textgreater{}\ Reindent\ lines} dans RStudio, ou
\texttt{\textless{}Ctrl\textgreater{}+A,\ \textless{}Ctrl\textgreater{}+I},
en remplaçant par sous Mac).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{signe3 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
  \ControlFlowTok{if}\NormalTok{ (x}\SpecialCharTok{==}\DecValTok{0}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(x, }\StringTok{"n\textquotesingle{}est ni négatif ni positif"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \ControlFlowTok{if}\NormalTok{ (x }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) \{}
      \FunctionTok{cat}\NormalTok{(x, }\StringTok{"est positif"}\NormalTok{)}
\NormalTok{    \}}
    \ControlFlowTok{if}\NormalTok{ (x }\SpecialCharTok{\textless{}} \DecValTok{0}\NormalTok{) \{}
      \FunctionTok{cat}\NormalTok{(x, }\StringTok{"est négatif"}\NormalTok{)}
\NormalTok{    \}  }
\NormalTok{  \}}
\NormalTok{\}}

\FunctionTok{signe3}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
0 n'est ni négatif ni positif
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe3}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
-1 est négatif
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe3}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
5 est positif
\end{verbatim}

Ce comportement de choix multiples se généralise au delà de deux avec
\texttt{switch}.

Vous pouvez tester plusieurs choses à la fois mais le résultat doit être
un \texttt{logical} de longueur 1, c'est à dire soit \texttt{TRUE} soit
\texttt{FALSE}. Si par exemple vous voulez tester si un nombre est
positif ET inférieur à 10 alors vous utiliserez un patron de ce genre
pour \texttt{cond} :

\begin{verbatim}
if ((x > 0) & (x < 10))
\end{verbatim}

Finis les messages à la console, nous allons désormais retourner des
nombres, en l'occurence \texttt{-1} si \texttt{x} est négatif,
\texttt{1} sinon (zéro y compris):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{signe4 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \ControlFlowTok{if}\NormalTok{ (x}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{)}
    \SpecialCharTok{{-}}\DecValTok{1}
  \ControlFlowTok{else}
    \DecValTok{1}
\NormalTok{\}}

\FunctionTok{signe4}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe4}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe4}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
\end{verbatim}

Au passage, un exemple d'omission d'accolades lorsqu'une seule ligne est
à exécuter. Cette structure aussi compacte avec un seul \texttt{if} et
un seul \texttt{else}, et surtout une seule valeur retournée peut
s'écrire de façon plus compacte avec \texttt{ifelse} suivante le patron
: \texttt{ifelse(cond,\ expr\_ifTRUE,\ expr\_ifFALSE)} dans ce goût là :
\texttt{signe5\ \textless{}-\ function(x)\ ifelse(x\textless{}0,\ -1,\ 1)}

À ce moment de votre existence, vous vous dites ``génial, je vais
pouvoir balancer un vecteur à \texttt{signe5} et aller à la plage''.
Modérez votre enthousiasme :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{signe4}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{:}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning in if (x < 0) -1 else 1: the condition has length > 1 and only the first
element will be used
\end{verbatim}

\begin{verbatim}
[1] -1
\end{verbatim}

Cette commande aurait pu marcher, via un recyclage dans votre dos, mais
ce n'est pas le cas, ce qui nous donne - heureux hasard - une transition
rêvée vers \texttt{for}. Notez bien que je vous montre \texttt{for} mais
que normalement vous ne devriez presque jamais en avoir besoin grâce à
\texttt{map} et ses variantes, dans le package \texttt{purrr}.

\hypertarget{for}{%
\section{\texorpdfstring{\texttt{for}}{for}}\label{for}}

Parcourir les valeurs d'un vecteur, d'une matrice, etc. et agir avec ces
valeurs est une tâche très courante en programmation. \texttt{for}
permet de balayer un vecteur donné et d'assigner temporairement cette
valeur à une autre variable, généralement appelée \texttt{i} :

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{) \{}
  \FunctionTok{print}\NormalTok{(i}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
[1] 4
[1] 9
[1] 16
[1] 25
\end{verbatim}

Le code ci-dessus devrait être transparent. Une précision toutefois : je
suis obligé de forcer l'impression à la console avec \texttt{print} (une
variante moins subtile de \texttt{cat}) sinon ce qu'il se passe dans les
accolades de \texttt{for} y resterait, sans conséquence visible.

Si vous voulez utiliser les résultats d'un calcul au sein d'une boucle
\texttt{for}, ce qui est le cas le plus fréquent, vous devez l'assigner
à un objet compatible préalablement crée. De plus, on utilise
généralement un vecteur avec toutes les valeurs à balayer par
\texttt{i}. Plutôt que d'utiliser cette chose : \texttt{1:length(x)}, on
préferera le plus court et souvent plus générique \texttt{seq\_along(x)}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\NormalTok{res }\OtherTok{\textless{}{-}} \FunctionTok{vector}\NormalTok{(}\StringTok{"numeric"}\NormalTok{, }\AttributeTok{length=}\FunctionTok{length}\NormalTok{(x))}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(x))\{}
\NormalTok{  res[i] }\OtherTok{\textless{}{-}}\NormalTok{ x[i]}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{\}}
\NormalTok{res}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  1  4  9 16 25
\end{verbatim}

Au risque de me répéter, vous ne devriez pas avoir trop besoin de
\texttt{for} si vous maîtrisez \texttt{map}, qui est plus compact, plus
explicite et le plus souvent plus rapide :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{purrr}\SpecialCharTok{::}\FunctionTok{map\_dbl}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\SpecialCharTok{\textasciitilde{}}\NormalTok{.x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  1  4  9 16 25
\end{verbatim}

\hypertarget{while-et-al.}{%
\section{\texorpdfstring{\texttt{while} et
al.}{while et al.}}\label{while-et-al.}}

Je ne m'attarde pas sur les autres structures de contrôles, bien moins
utilisées, très bien décrites ailleurs et plutôt compréhensibles si vous
avez survécu jusqu'ici : \texttt{while}, \texttt{next}, \texttt{repeat},
\texttt{break}, etc.

\hypertarget{fonctions-1}{%
\section{Fonctions}\label{fonctions-1}}

Les fonctions sont des unités de code qui remplissent une fonction
donnée qui n'existe nulle part dans R\footnote{ou plus probablement vous
  n'avez tout exploré
  \href{https://cran.r-project.org/web/packages/available_packages_by_name.html}{ici}
  :-)}. Elles sont au coeur de R, et plus largement de tous les
environnements de programmation. Paraxalement et même si elles peuvent
effrayer au début, il n'y a pas grand chose à connaître sur les
fonctions !

\begin{itemize}
\item
  Définir une fonction plutôt que copier-coller son code à chaque fois
  que vous en avez besoin est non seulement bien pratique mais aussi
  plus sûr : si vous avez une modification à faire vous la faites une
  fois dans la définition de fonction, pas partout.
\item
  Idéalement une fonction fait une seule chose mais bien ! Faire des
  fonctions qui font aussi le café est un tropisme de débutant·e·s mais
  aue l'on perd vite. Oubliez donc \texttt{all\_my\_PhD\_results()} et
  décomposez vos fonctions. Vos collaborateurs et vous-même dans six
  mois (c'est pareil), vous en sauront gré.
\item
  Idéalement toujours, sauf pour les cas les plus triviaux, une fonction
  est documentée sur le modèle de la doc de R: c'est à dire son
  fonctionnement, les différents arguments, ce qu'elle retourne, des
  détails éventuels et des exemples. Commentez également l'intérieur de
  vos fonctions, ce sera utile pour tous y compris vous-même et tout de
  suite.
\item
  Pour les scripts les plus complexes, vous pouvez regrouper vos
  fonctions dans un script indépendant, et le \texttt{source} r en début
  de votre script d'analyse ou de votre document Quarto\footnote{pour
    donner un ordre de grandeur, sur mes cinq derniers projets de
    consulting, tous les scripts finaux dépassent les 500 lignes mais
    sourcent des scripts qui font plus de 1000 lignes, dont presque la
    moitié de commentaires !}.
\end{itemize}

\begin{quote}
Ne soyez pas timides, crééz vos fonctions à chaque fois que vous répétez
le même code
\end{quote}

Passons aux choses sérieuses.

Les fonctions sont définies avec la fonction \texttt{fonction} suivant
le patron :

\begin{verbatim}
nom_fonction <- function(arg1=default1, arg2=default2, ...) {
  # instructions
  return()
}
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Une fonction peut avoir zéro, un, plusieurs, ou même un nombre
  indéfini d'arguments.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 0 argument}
\NormalTok{say\_hi }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{() }\FunctionTok{cat}\NormalTok{(}\StringTok{"hi there"}\NormalTok{)}
\CommentTok{\# try it: say\_hi()}

\CommentTok{\# pass arguments to internal functions with \textasciigrave{}...\textasciigrave{}}
\NormalTok{my\_boxplot }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, y, ...)\{}
  \FunctionTok{boxplot}\NormalTok{(x, y, ...)}
\NormalTok{\}}
\CommentTok{\# try it: my\_boxplot(iris$Petal.Length, iris$Species, col="grey50")}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Une fonction a des arguments nommés. Quand c'est possible avec une
  valeur par défaut. Ces valeurs peuvent être calculées ``à la volée''
  sur d'autres arguments (voir \texttt{by} dans \texttt{?seq}).
\item
  Une fonction peut utiliser une fonction comme argument (\texttt{FUN}
  dans \texttt{apply} par exemple)
\item
  Une fonction peut retourner une fonction\footnote{Je vous laisse avec
    \href{https://adv-r.hadley.nz/function-factories.html}{Hadley}, et
    chercher du paracétamol}
\end{itemize}

\begin{itemize}
\tightlist
\item
  Le code d'une fonction est accessible, la plupart du temps, en tapant
  le nom de la fonction sans parenthèse :
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{say\_hi}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
function() cat("hi there")
\end{verbatim}

\begin{itemize}
\item
  Une fonction ne peut retourner qu'un seul objet. Si vous avez
  plusieurs, il vous faut en passer par une liste, si possible nommée :
  \texttt{return(list(res1=...\ res2=...))}
\item
  Idéalement, une fonction peut parer à toutes les situations avec un
  message d'erreur informatif ou a minima une gestion de l'erreur. Je
  vous mets à l'aise, ce n'est presque jamais le cas :
  \texttt{plot("a")} n'est pas vraiment explicite et ne point pas le
  vrai problème.
\item
  Quand vous commencez à avoir un joli paquet de fonctions, il est temps
  de penser à créer un package, pour vous-même ou pour le monde et dans
  un premier temps de lire la section consacrée plus loin.
\end{itemize}

\hypertarget{un-mot-sur-les-muxe9thodes}{%
\section{Un mot sur les méthodes}\label{un-mot-sur-les-muxe9thodes}}

Les fonctions peuvent avoir un comportement différent selon la classe de
l'argument sur lequel elles opèrent. Un exemple trivial est
\texttt{summary} qui retourne des quantiles quand on lui passe un
\texttt{numeric}, et un descriptif plus sommaire quand on lui passe un
\texttt{character} :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1       2       3       3       4       5 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Length     Class      Mode 
        5 character character 
\end{verbatim}

\texttt{summary} est une \emph{méthode} plus qu'une fonction, une
\emph{façon} de faire une chose (un résumé en l'occurence) sur une
variable qui \emph{dépend} de la classe de cette variable.

Voyons d'abord comment déclarer une méthode. Nous allons l'appeler
\texttt{shout}, pour crier en anglais. Quand \texttt{shout} sera appelée
sur un \texttt{character} elle le passera en majuscules; sur un
\texttt{numeric} elle élèvera au carré.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{shout }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{UseMethod}\NormalTok{(}\StringTok{"shout"}\NormalTok{, x)}
\NormalTok{\}}

\NormalTok{shout.default }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{stop}\NormalTok{(}\StringTok{"\textquotesingle{}shout\textquotesingle{} not defined on this class"}\NormalTok{)}
\NormalTok{\}}

\NormalTok{shout.character }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{toupper}\NormalTok{(x)}
\NormalTok{\}}

\NormalTok{shout.numeric }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  x}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{\}}

\CommentTok{\# shout(iris) \# try this on your machine}
\FunctionTok{shout}\NormalTok{(}\StringTok{"let\textquotesingle{}s be quiet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "LET'S BE QUIET"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{shout}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  1  4  9 16 25
\end{verbatim}

C'est bien joli tout ça, mais n'aurait-on pas pu caler un bon vieux
\texttt{is.numeric} et tout déclarer dans une fonction. Oui, bravo, vous
avez raison (j'ai créé un monstre). Mais pas vraiment (du calme jeune
padawan) car les méthodes peuvent faire bien plus que cela, et notamment
donner une saveur ``orientée objet'' à R.

Il existe plusieurs systèmes de déclaration de méthodes en R, et plus
largement de programmation orientée objet, on peut citer \texttt{S3},
\texttt{S4}, \texttt{R6}, etc. Le présent document ne s'attardera pas
plus sur les méthodes mais les lignes ci-dessous démineront probablement
quelques mystères de R.

Pour afficher toutes les méthodes, on utilisera la fonction
\texttt{methods} qui peut s'appeler soit sur le nom soit sur la classe :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{methods}\NormalTok{(}\StringTok{"shout"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] shout.character shout.default   shout.numeric  
see '?methods' for accessing help and source code
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{methods}\NormalTok{(}\AttributeTok{class=}\StringTok{"character"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] all.equal                as.data.frame            as.Date                 
 [4] as.POSIXlt               as.raster                coerce                  
 [7] coerce<-                 formula                  getDLLRegisteredRoutines
[10] Ops                      shout                   
see '?methods' for accessing help and source code
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# try: methods("plot") \# graphs, graphs, everywhere}
\CommentTok{\# or even: methods("summary") \# !!!}
\end{Highlighting}
\end{Shaded}

Comme on l'a vu précédemment, pour accéder au code d'une méthode on
pourrait imaginer qu'il suffise, comme pour toute fonction de taper son
nom à la console, sans parenthèses. Ici, le nom ne suffit pas, il faut
également le suffixe de classe :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{shout }\CommentTok{\# not what I wanted but still, we know it\textquotesingle{}s a method not a bare function}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
function(x) {
  UseMethod("shout", x)
}
<bytecode: 0x7f8316bc8d80>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{shout.character}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
function(x) {
  toupper(x)
}
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{shout.numeric}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
function(x) {
  x^2
}
\end{verbatim}

\hypertarget{un-mot-sur-les-packages-1}{%
\section{Un mot sur les packages}\label{un-mot-sur-les-packages-1}}

C'est un exercice très instructif, valorisant, valorisable et devenu
quasiment facile de nos jours.

La référence absolue est \emph{R packages} d'Hadley Wickham, qui a le
bon goût d'être libre : \href{}{https://r-pkgs.org/}

Les tables de la loi sont plus dures mais ce sont les lois :
\href{Writing\%20R\%20extensions\%20--\%20official\%20R\%20documentation}{https://cran.r-project.org/doc/manuals/r-release/R-exts.html}

\bookmarksetup{startatroot}

\hypertarget{moduxe9lisation-statistique-lm}{%
\chapter{\texorpdfstring{Modélisation statistique :
\texttt{lm}}{Modélisation statistique : lm}}\label{moduxe9lisation-statistique-lm}}

Ce document introduit l'aspect le plus basique de modélisation mais qui
inspire ou dont dérivent tous les autres : le modèle linéaire aka
\texttt{lm}.

Nous allons nous contenter du jeu de données \texttt{iris} et en
particulier d'analyser la relation, si elle existe, entre la longueur et
la largeur des pétales.

\begin{quote}
Avant de faire des modèles, faites des graphes !
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Petal.Width }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Petal.Length, }\AttributeTok{data=}\NormalTok{iris, }
     \AttributeTok{main=}\StringTok{"is petal width \textasciitilde{} petal length ?"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{modelling_files/figure-pdf/unnamed-chunk-1-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Petal.Width }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Petal.Length, }\AttributeTok{data=}\NormalTok{iris)}
\NormalTok{mod}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = Petal.Width ~ Petal.Length, data = iris)

Coefficients:
 (Intercept)  Petal.Length  
     -0.3631        0.4158  
\end{verbatim}

\hypertarget{formula}{%
\subsection{formula}\label{formula}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(mod)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{modelling_files/figure-pdf/unnamed-chunk-3-1.pdf}

}

\end{figure}

\begin{figure}[H]

{\centering \includegraphics{modelling_files/figure-pdf/unnamed-chunk-3-2.pdf}

}

\end{figure}

\begin{figure}[H]

{\centering \includegraphics{modelling_files/figure-pdf/unnamed-chunk-3-3.pdf}

}

\end{figure}

\begin{figure}[H]

{\centering \includegraphics{modelling_files/figure-pdf/unnamed-chunk-3-4.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#predict()}
\end{Highlighting}
\end{Shaded}

\bookmarksetup{startatroot}

\hypertarget{ceci-nest-pas-quun-opuxe9rateur-et-magrittr}{%
\chapter{\texorpdfstring{Ceci n'est pas qu'un opérateur :
\texttt{\%\textgreater{}\%} et
\texttt{magrittr}}{Ceci n'est pas qu'un opérateur : \%\textgreater\% et magrittr}}\label{ceci-nest-pas-quun-opuxe9rateur-et-magrittr}}

Plop

\bookmarksetup{startatroot}

\hypertarget{importer-ses-donnuxe9es}{%
\chapter{Importer ses données}\label{importer-ses-donnuxe9es}}

\hypertarget{bonnes-pratiques}{%
\section{Bonnes pratiques}\label{bonnes-pratiques}}

\hypertarget{import}{%
\section{Import}\label{import}}

\hypertarget{read.table}{%
\subsection{\texorpdfstring{\texttt{read.table}}{read.table}}\label{read.table}}

\hypertarget{rstudio-1}{%
\subsection{\texorpdfstring{\texttt{Rstudio}}{Rstudio}}\label{rstudio-1}}

\hypertarget{readr}{%
\subsection{\texorpdfstring{\texttt{readr}}{readr}}\label{readr}}

\hypertarget{load}{%
\subsection{\texorpdfstring{\texttt{load}}{load}}\label{load}}

\hypertarget{exports}{%
\section{Exports}\label{exports}}

\hypertarget{write.table}{%
\subsection{write.table}\label{write.table}}

\hypertarget{write_csv-etc.}{%
\subsection{write\_csv, etc.}\label{write_csv-etc.}}

\hypertarget{save}{%
\subsection{\texorpdfstring{\texttt{save}}{save}}\label{save}}

\hypertarget{autres-ios}{%
\section{Autres I/Os}\label{autres-ios}}

\begin{itemize}
\tightlist
\item
  readlines
\item
  httr
\item
  yaml
\item
  xlsx
\end{itemize}

\bookmarksetup{startatroot}

\hypertarget{manipulation-de-donnuxe9es-avec-dplyr}{%
\chapter{\texorpdfstring{Manipulation de données avec
\texttt{dplyr}}{Manipulation de données avec dplyr}}\label{manipulation-de-donnuxe9es-avec-dplyr}}

\hypertarget{tibble}{%
\section{\texorpdfstring{\texttt{tibble}}{tibble}}\label{tibble}}

\hypertarget{rename}{%
\section{\texorpdfstring{\texttt{rename}}{rename}}\label{rename}}

\hypertarget{select}{%
\section{\texorpdfstring{\texttt{select}}{select}}\label{select}}

\hypertarget{tidyselect}{%
\section{\texorpdfstring{\texttt{tidyselect}}{tidyselect}}\label{tidyselect}}

\hypertarget{filter}{%
\section{\texorpdfstring{\texttt{filter}}{filter}}\label{filter}}

\hypertarget{mutate}{%
\section{\texorpdfstring{\texttt{mutate}}{mutate}}\label{mutate}}

\hypertarget{transmute}{%
\section{\texorpdfstring{\texttt{transmute}}{transmute}}\label{transmute}}

\hypertarget{summarise}{%
\section{\texorpdfstring{\texttt{summarise}}{summarise}}\label{summarise}}

\hypertarget{group_by}{%
\section{\texorpdfstring{\texttt{group\_by}}{group\_by}}\label{group_by}}

\hypertarget{rowwise}{%
\section{\texorpdfstring{\texttt{rowwise}}{rowwise}}\label{rowwise}}

\hypertarget{join}{%
\section{\texorpdfstring{\texttt{join}}{join}}\label{join}}

\hypertarget{nest}{%
\section{\texorpdfstring{\texttt{nest}}{nest}}\label{nest}}

\hypertarget{cheat-sheet}{%
\section{\texorpdfstring{\texttt{cheat\ sheet}}{cheat sheet}}\label{cheat-sheet}}

\bookmarksetup{startatroot}

\hypertarget{nettoyer-ses-donnuxe9es-avec-tidyr}{%
\chapter{\texorpdfstring{Nettoyer ses données avec
\texttt{tidyr}}{Nettoyer ses données avec tidyr}}\label{nettoyer-ses-donnuxe9es-avec-tidyr}}

\bookmarksetup{startatroot}

\hypertarget{graphiques-avec-ggplot2}{%
\chapter{\texorpdfstring{Graphiques avec
\texttt{ggplot2}}{Graphiques avec ggplot2}}\label{graphiques-avec-ggplot2}}

\hypertarget{rationale}{%
\section{Rationale}\label{rationale}}

Il est peu dire que le package \texttt{ggplot2} a changé la face de la
représentation graphique en R.

Le package de base, \texttt{graphics}\footnote{\texttt{?graphics}}
permet certes de tout faire mais laborieusement. D'autres packages
(\texttt{lattice} par exemple) permettent une création plus proche de
l'utilisateur·trice, moins proches des ``primitives'' (segments, points,
etc.) graphiques.

La force de \texttt{ggplot2}, d'abord écrit par Hadley Wickham, est
d'implémenter la \emph{Grammar of Graphics} de Leland Wilkinson qui
dissocie les données de leurs représentations, de façon déclarative.
Nous déclarerons ainsi à un jeu de données, des modes de représentation
(des \texttt{geom\_}) qui s'appuieront eux-mêmes sur des déclarations
d'axes des abscisses, des ordonées, des couleurs, des tailles etc. (via
\texttt{aes}), nous préciserons les axes (\texttt{coord\_}), les
paramètres de style \texttt{theme}.

Nous obtiendrons finalement un graphe que nous pourrons modifier à soit
et qui sera même, en soit, une machine à faire d'autres graphes.

\texttt{ggplot2} s'installe classiquement avec
\texttt{install.packages("ggplot2")} mais il est compris dans le
tidyverse que vous avez du installer précédemment avec
\texttt{install.packages("tidyverse")}.

Pour charger \texttt{ggplot2}, il suffit de taper
\texttt{library(ggplot2)} ou encore \texttt{library(tidyverse)}.

\hypertarget{un-premier-graphe}{%
\section{Un premier graphe}\label{un-premier-graphe}}

\texttt{ggplot2} travaille sur des \texttt{data.frame}s (ou des
\texttt{tibble}s mais c'est la même chose). Tout jeu de données qui
n'est pas un \texttt{data.frame} sera converti ou tenté de l'être avec
\texttt{fortify}. Le plus simple pour ne pas avoir de surprises étant de
convertir vos données en un \texttt{data.frame} en bonne et due forme,
vous-mêmes.

Nous allons utiliser \texttt{iris} qui est déjà un \texttt{data.frame}
mais que nous allons, pour la cosmétique, convertir en \texttt{tibble}
et en renommer les colonnes

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\OtherTok{\textless{}{-}}\NormalTok{ iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{pl=}\NormalTok{Petal.Length, }\AttributeTok{pw=}\NormalTok{Petal.Width,}
         \AttributeTok{sl=}\NormalTok{Sepal.Length, }\AttributeTok{sw=}\NormalTok{Sepal.Width, }\AttributeTok{sp=}\NormalTok{Species)}
\NormalTok{iris2 }\CommentTok{\# iris, as tibble and with more compact column names}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 150 x 5
      sl    sw    pl    pw sp    
   <dbl> <dbl> <dbl> <dbl> <fct> 
 1   5.1   3.5   1.4   0.2 setosa
 2   4.9   3     1.4   0.2 setosa
 3   4.7   3.2   1.3   0.2 setosa
 4   4.6   3.1   1.5   0.2 setosa
 5   5     3.6   1.4   0.2 setosa
 6   5.4   3.9   1.7   0.4 setosa
 7   4.6   3.4   1.4   0.3 setosa
 8   5     3.4   1.5   0.2 setosa
 9   4.4   2.9   1.4   0.2 setosa
10   4.9   3.1   1.5   0.1 setosa
# i 140 more rows
\end{verbatim}

Les étapes suivantes sont toujours les mêmes :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  déclarer le \texttt{data.frame}à utiliser (\texttt{iris2} ici)
\item
  déclarer quelles colonnes doivent être utilisées (nous voulons la
  largeur de pétale \texttt{pw} en fonction, en \texttt{y} en somme, de
  la longueur de pétale \texttt{pw}).
\item
  déclarer le mode de représentation (ici un nuage de points
  \texttt{geom\_point}, mais quantité d'autres \texttt{geom} existent
  comme les histogrammes, les boxplots, etc.)
\end{enumerate}

\texttt{ggplot2} utilise l'opérateur \texttt{+} pour assembler ces
différentes couches, après la fonction \texttt{ggplot()} qui initie le
graphe.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{pl, }\AttributeTok{y=}\NormalTok{pw) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-3-1.pdf}

}

\end{figure}

Vous trouverez parfois la déclaration du \texttt{data.frame}
\texttt{aes} au sein de \texttt{ggplot()} comme cela :
\texttt{ggplot(iris2,\ aes(x=pw,\ y=pl))}. J'ai tendance à tout éclater
comme ci-dessus, mais à vous de voir.

\hypertarget{un-deuxiuxe8me-geom-et-un-sacrifice}{%
\section{\texorpdfstring{Un deuxième \texttt{geom} et un
sacrifice}{Un deuxième geom et un sacrifice}}\label{un-deuxiuxe8me-geom-et-un-sacrifice}}

Si vous vous amusiez à compter le nombre de points représentés, ou plus
intelligemment
\texttt{iris2\ \%\textgreater{}\%\ select(pl,\ pw)\ \%\textgreater{}\%\ unique()\ \%\textgreater{}\%\ nrow()},
vous réaliseriez que 42 points ne sont pas visibles. La faute n'en
incombe nullement à \texttt{ggplot2} mais à la précision des instruments
de mesure au moment de l'acquisition de données ! Plus exactement, ils
sont visibles mais superposés.

Cette mise en garde nous donne l'occasion de présenter un deuxième
\texttt{geom} qui introduit suffisamment de bruit dans les données pour
que tous les points soient représentés tout en gardant la relation
générale entre les deux variables \texttt{pw} et \texttt{pl}. En
d'autres termes, nous sacrifions l'exactitude pour gagner en fidélité du
nombre de points effectivements présents.

La représentation visuelle de l'information quantitative est souvent
affaire de sacrifices et elle est un domaine de recherche à part
entière. Offrez-vous ou faites vous offrir la bibliographie complète
d'Edward Tufte !

Voilà un \texttt{iris2} avec ses 150 iris :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw) }\SpecialCharTok{+} 
  \FunctionTok{geom\_jitter}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-4-1.pdf}

}

\end{figure}

\hypertarget{aes-dautres-variables-sur-le-muxeame-graphe}{%
\section{\texorpdfstring{\texttt{aes} : d'autres variables sur le même
graphe}{aes : d'autres variables sur le même graphe}}\label{aes-dautres-variables-sur-le-muxeame-graphe}}

\texttt{aes} règle les \emph{aesthetics} de votre \texttt{ggplot}. Si
par exemple vous voulez associer chaque espèce à une couleur, il vous
suffit de rajouter \texttt{col=sp} dans \texttt{aes()} et la légende est
automatiquement générée :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp) }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-5-1.pdf}

}

\end{figure}

Dans le même esprit, si vous vouliez rajouter les dimensions des sépales
comme encodage des tailles de point, c'est dans \texttt{aes()} que ça se
passe. Vous pouvez même créer à la volée, dans \texttt{aes} même, des
opérations sur les colonnes de \texttt{iris2}. Une ``pseudo-aire'',
faisant fi de la forme mais intégrant la longueur et la largeur des
sépales peut se créer comme suit :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp, }\AttributeTok{size=}\NormalTok{sw}\SpecialCharTok{*}\NormalTok{sl) }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-6-1.pdf}

}

\end{figure}

\hypertarget{tendances-et-moduxe8les-statistiques}{%
\section{Tendances et modèles
statistiques}\label{tendances-et-moduxe8les-statistiques}}

La production de graphes est centrale dans l'exploration de données et
\texttt{ggplot2} en fait une tâche simple. \texttt{stat\_smooth} va
ajouter une courbe de tendance aux données représentées.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{aes}\NormalTok{(pl, pw) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{stat\_smooth}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-7-1.pdf}

}

\end{figure}

Deux choses. D'abord, \texttt{ggplot2} vous avertit que la courbe
ajoutée utilise \texttt{loess}, c'est à dire un ajustement polynomial
local calé sur \texttt{y\textasciitilde{}x}. Si ces messages vous
ennuient, il vous suffit de préciser à \texttt{geom\_smooth} d'utiliser
ces modèles
(\texttt{geom\_smooth(method="loess",\ formula="y\textasciitilde{}x")}).
Ensuite, peut être vous aviez plutôt en tête un bon vieux modèle
linéaire avec \texttt{lm} plutôt que ce \texttt{loess} certes flatteur
mais qui ne sied peut-être pas à votre esprit naturellement
parcimonieux. Bonne nouvelle, c'est très simple :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-8-1.pdf}

}

\end{figure}

Après avoir contemplé ce graphe, vous vous dites que ce modèle linéaire,
moyennant que la longueur de pétale soit inférieure à 2 vous prédirait
des largeurs de pétales négatives. Ce qui vous en conviendrez n'a guère
de sens, ni pour un·e biologiste, ni même pour un·e statisticien·ne
(c'est dire !).

Vous l'avez deviné si vous avez déjà utilisé \texttt{lm()}, ça se passe
dans dans la spécification de la \texttt{formula}. Pour forcer le modèle
à ne pas avoir d'intercept (ou plutôt un intercept égal à 0), vous
pouvez spécifier \texttt{-1} dans la formule. Je sais que ce n'est pas
très intuitif mais vous consulterez avec volupté \texttt{?formula} pour
plus d'informations.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x{-}1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-9-1.pdf}

}

\end{figure}

Dans le même esprit si nous voulions forcer la relation à être
quadratique, nous aurions pu :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}I(x\^{}2)+x{-}1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-10-1.pdf}

}

\end{figure}

La couleur de la droite (ou de la courbe) de régression, ainsi que la
présence ou non d'un intervalle de confiance peuvent se préciser,
toujours dans \texttt{geom\_smooth}. Par exemple :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x{-}1"}\NormalTok{, }\AttributeTok{se=}\ConstantTok{FALSE}\NormalTok{, }\AttributeTok{col=}\StringTok{"red"}\NormalTok{, }\AttributeTok{linetype=}\StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-11-1.pdf}

}

\end{figure}

Ces paramètres \texttt{se} et \texttt{colour} sont documentés dans
\texttt{?geom\_smooth} et ne s'appliquent qu'à ce \texttt{geom}, pas à
l'échelle globale du \texttt{ggplot} ni même des autres \texttt{geom}s.
Par exemple :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x"}\NormalTok{, }\AttributeTok{col=}\StringTok{"green"}\NormalTok{, }\AttributeTok{se=}\ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x{-}1"}\NormalTok{, }\AttributeTok{col=}\StringTok{"purple"}\NormalTok{) }\CommentTok{\# no intercept}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-12-1.pdf}

}

\end{figure}

Un petit rappel à la doxa ne faisant jamais de mal :

\begin{quote}
ce n'est pas parce que produire des droites/courbes de tendance est
facile que vous êtes autorisé·e à le faire
\end{quote}

Si votre modèle n'est pas ``significatif'', vous n'êtes pas vraiment
autorisé·e à le représenter. Naturellement vous pouvez le faire en
cachette mais dans un article vous allez vous faire tomber dessus par
le·a post-doc qui se tape la review !

Il n'y a aucun moyen à ma connaissance de le faire avec
\texttt{ggplot2}, ni même de récupérer les modèles créés en interne par
ce dernier mais vous aurez, quoiqu'il en soit, besoin de les explorer
par ailleurs. Recréeons le modèle sans intercept :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(pw}\SpecialCharTok{\textasciitilde{}}\NormalTok{pl}\DecValTok{{-}1}\NormalTok{, }\AttributeTok{data=}\NormalTok{iris2)}
\NormalTok{mod}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = pw ~ pl - 1, data = iris2)

Coefficients:
    pl  
0.3365  
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(mod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = pw ~ pl - 1, data = iris2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48446 -0.24366 -0.13699  0.08642  0.68379 

Coefficients:
   Estimate Std. Error t value Pr(>|t|)    
pl 0.336511   0.005063   66.46   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2573 on 149 degrees of freedom
Multiple R-squared:  0.9674,    Adjusted R-squared:  0.9672 
F-statistic:  4417 on 1 and 149 DF,  p-value: < 2.2e-16
\end{verbatim}

Sans surprise, le modèle linéaire est ``significatif'' et le(s) R2
excellents. Vous pouvez donc représenter ces modèles.

Le clou du spectacle désormais : si nous avons déclaré une couleur par
espèce d'iris, le reste suit. Le reste ici étant un modèle linéaire.
Tadan !

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Notons que si vous ne voulez PAS que le reste suive, en termes plus
formels que \texttt{geom\_smooth()} n'hérite pas des paramètres globaux
de \texttt{aes}, il vous suffit de déclarer un \texttt{aes} local au
paramètre \texttt{mapping}, le premier argument de tous les
\texttt{geom} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{col=}\ConstantTok{NULL}\NormalTok{), }\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-15-1.pdf}

}

\end{figure}

\hypertarget{interlude-cosmuxe9tique-labs-theme-et-scale_}{%
\section{\texorpdfstring{Interlude cosmétique : \texttt{labs},
\texttt{theme} et
\texttt{scale\_}}{Interlude cosmétique : labs, theme et scale\_}}\label{interlude-cosmuxe9tique-labs-theme-et-scale_}}

Puisque je sens que vous commencez à tomber éperdument amoureux·se de
\texttt{ggplot2}, il est temps d'enfoncer le clou avec un peu de
cosmétique.

Le nom des axes ainsi que les titres et sous-titres sont faciles à
modifier :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ gg }\SpecialCharTok{+} 
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Petal length (mm)"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Petal width (mm)"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title=}\StringTok{"Another iris graph"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"beware of those who don\textquotesingle{}t like flowers"}\NormalTok{)}
\NormalTok{gg}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-16-1.pdf}

}

\end{figure}

Le ``thème'' général des graphes peut être modifié. Vous pouvez essayer
les autres, tapez \texttt{theme\_} puis pressez
\texttt{\textless{}Tab\textgreater{}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-17-1.pdf}

}

\end{figure}

Chaque élément individuel peut être modifié. Sachez que c'est un terrain
glissant, susceptible de vous désociabiliser. Avec un peu de sueur on
fait exactement ce que l'on veut, y compris pire :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face=}\StringTok{"bold"}\NormalTok{),}
           \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle=}\DecValTok{45}\NormalTok{),}
           \AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill=}\StringTok{"pink"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-18-1.pdf}

}

\end{figure}

Si l'un des thèmes vous convient et/ou que vous en avez customisé un,
vous pouvez le définir pour tous les graphes avec \texttt{theme\_set}.

Enfin, et l'on s'écarte un peu de la pure cosmétique, vous pouvez
ajuster les systèmes de représentation des axes, à commencer par leurs
limites :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-19-1.pdf}

}

\end{figure}

Pour la seule étendue, on préferera \texttt{xlim()} et \texttt{ylim()}
mais la fonction \texttt{scale\_x\_continuous} fait beaucoup plus.

Vous pouvez même changer le système de coordonnées. Si par exemple vous
représentez un plan factoriel d'ACP, vous aurez besoin de contraindre
l'aspect \texttt{y/x} de telle façon qu'un centimètre sur \texttt{x} à
l'écran, représente également un centimètre sur \texttt{y}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{coord\_equal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-20-1.pdf}

}

\end{figure}

Les régressions sont moins flatteuses \footnote{petite filouterie : si
  vous voulez convaincre visuellement, arrangez vous pour que vos
  regressions aient un angle de 45°} mais on a bel et bien un plan
euclidien.

Enfin, vous pétez les plombs et vous vous lancez dans l'étude des vents,
ou quoique ce soit d'autre avec des coordonées polaires. La famille
\texttt{coord\_*} vous permet de changer carrément le système de
coordonées :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{coord\_polar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-21-1.pdf}

}

\end{figure}

\texttt{coord\_flip} vous sera aussi utile si vous désirez culbuter le
graphe et passer les \texttt{x} en \texttt{y} et vice-versa.

\hypertarget{geom-suite-deux-variables-continues}{%
\section{\texorpdfstring{\texttt{geom} (suite) : deux variables
continues}{geom (suite) : deux variables continues}}\label{geom-suite-deux-variables-continues}}

Moult autres \texttt{geom}s sont disponibles dans \texttt{ggplot2} et
sont présentés graphiquement
\href{https://ggplot2.tidyverse.org/reference/\#layers}{ici}.

Pour continuer sur deux variables continues, on pourra rajouter
facilement des courbes ou autres éléments de densité. Toutes les
opérations kernel sont faites pour vous donc vous n'avez pas vraiment à
vous en soucier. 150 points c'est un peu limite pour ces fonctions mais
restons fidèles à \texttt{iris} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{aes}\NormalTok{(pl, pw)}
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_density2d}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-22-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_bin\_2d}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-22-2.pdf}

}

\end{figure}

Naturellement, vous pouvez rajouter les points. L'ordre de
représentation est celui des déclarations. Si vous passez
\texttt{geom\_point} après \texttt{geom\_density2d}, les points seront
représentés au-dessus des courbes de densité :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_density2d\_filled}\NormalTok{(}\AttributeTok{col=}\StringTok{"grey90"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{col=}\StringTok{"white"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{coord\_equal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-23-1.pdf}

}

\end{figure}

Classieux n'est-ce pas ?

\hypertarget{geom-suite-une-seule-variable-continue}{%
\section{\texorpdfstring{\texttt{geom} (suite) : une seule variable
continue}{geom (suite) : une seule variable continue}}\label{geom-suite-une-seule-variable-continue}}

Quand vous n'avez qu'une seule variable continue c'est vraisemblablement
que vous vous intéressez à sa distribution, c'est à dire que vous voulez
un histogramme ou sa densité, selon que vous vouliez binner vos données
ou les garder continues. Quelques exemples ci-dessous et je vous laisse
explorer en autonomie.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{aes}\NormalTok{(pl)}
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-24-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_density}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-24-2.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_dotplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-24-3.pdf}

}

\end{figure}

\begin{quote}
Quand \texttt{ggplot2} et plus généralement \texttt{R} vous enquiquine
avec un message c'est souvent pour votre bien.
\end{quote}

\hypertarget{geom-suite-une-variable-continue-et-un-facteur}{%
\section{\texorpdfstring{\texttt{geom} (suite) : une variable continue
et un
facteur}{geom (suite) : une variable continue et un facteur}}\label{geom-suite-une-variable-continue-et-un-facteur}}

\texttt{ggplot2} a tout ce qu'il vous faut pour représenter des boxplots
et variantes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sp, }\AttributeTok{y=}\NormalTok{pl, }\AttributeTok{fill=}\NormalTok{sp)}
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-25-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{geom\_violin}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_jitter}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-25-2.pdf}

}

\end{figure}

\hypertarget{les-sous-graphes-avec-facet_}{%
\section{\texorpdfstring{Les sous-graphes avec
\texttt{facet\_}}{Les sous-graphes avec facet\_}}\label{les-sous-graphes-avec-facet_}}

Une famille de fonction très puissante en \texttt{ggplot2} est celle des
\texttt{facet\_} qui vous permettent de faire des \texttt{sous-graphes}
facilement. Pour que l'exemple soit encore plus aiguisé, nous allons
créer une autre colonne facteur dans \texttt{iris2} simulant cinq
sessions de terrain, de mesure de 10 iris par espèce par session. Puis
nous allons créer un graphe de base, l'occasion de montrer l'utilisation
de \texttt{shape}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{session=}\FunctionTok{factor}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FunctionTok{rep}\NormalTok{(LETTERS[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], }\AttributeTok{each=}\DecValTok{10}\NormalTok{), }\DecValTok{3}\NormalTok{)))}
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp, }\AttributeTok{shape=}\NormalTok{session) }\SpecialCharTok{+} 
  \FunctionTok{geom\_jitter}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula=}\StringTok{"y\textasciitilde{}x{-}1"}\NormalTok{, }\AttributeTok{se=}\ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_linedraw}\NormalTok{()}
\NormalTok{gg}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-26-1.pdf}

}

\end{figure}

Nous conviendrons qu'on y voit goutte. Surtout entre sessions.
\texttt{facet\_grid} est votre ami. Vous pouvez spécifier qui va en
ligne, qui va en colonne et si les échelles doivent être fixes ou
peuvent être libres. Quelques exemples :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{facet\_grid}\NormalTok{(session}\SpecialCharTok{\textasciitilde{}}\NormalTok{sp)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-27-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{facet\_grid}\NormalTok{(.}\SpecialCharTok{\textasciitilde{}}\NormalTok{sp, }\AttributeTok{scales=}\StringTok{"free"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-27-2.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{facet\_grid}\NormalTok{(session}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{scales=}\StringTok{"fixed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-27-3.pdf}

}

\end{figure}

Pratique ! Notez que quand vous ne voulez qu'une dimension, vou spouvez
omettre l'un des membres à gauche ou à droite et le remplacer par un
\texttt{.}. \footnote{et \texttt{\textasciitilde{}sp} sans point à
  gauche fonctionnerait aussi.}

\texttt{facet\_wrap} est plus lâche dans sa définition et ne veut qu'une
seule colonne, dont les sous-graphes correspondant seront simplement
enroulés selon des dimensions plaisantes, que vous pouvez spécifier :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{session, }\AttributeTok{nrow=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-28-1.pdf}

}

\end{figure}

\hypertarget{interlude-cosmuxe9tique-scale_-suite-et-guides}{%
\section{\texorpdfstring{Interlude cosmétique : \texttt{scale\_} (suite)
et
\texttt{guides}}{Interlude cosmétique : scale\_ (suite) et guides}}\label{interlude-cosmuxe9tique-scale_-suite-et-guides}}

Si vous ne vous pâmez pas devant les couleurs par défaut, il est
naturellement possible de les changer avec une des fonctions
\texttt{scale\_color\_*}. Il en va de même pour les autres modes de
représentation définis dans \texttt{aes}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp, }\AttributeTok{size=}\NormalTok{sl) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{scale\_color\_viridis\_d}\NormalTok{(}\AttributeTok{option =} \StringTok{"B"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{scale\_size}\NormalTok{(}\AttributeTok{range=}\FunctionTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-29-1.pdf}

}

\end{figure}

Je vous laisse explorer les \texttt{scale\_} en autonomie. Oui, il y a
moyen d'y passer des journées. Le choix des couleurs est un sujet
central car il faut penser à tout le monde : les daltoniens, les
imprimantes noir et blanc. Et encore plus largement la perception des
couleurs par l'œil et le cerveau humains.

Vous pouvez également ne pas vous en réferer à des palettes
pré-construites et fixer vos propres couleurs avec un vecteur nommé et
l'une des fonctions \texttt{scale\_*\_manual} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sp\_cols }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"setosa"}\OtherTok{=}\StringTok{"navyblue"}\NormalTok{, }\StringTok{"versicolor"}\OtherTok{=}\StringTok{"purple"}\NormalTok{, }\StringTok{"virginica"}\OtherTok{=}\StringTok{"firebrick3"}\NormalTok{)}
\NormalTok{gg }\SpecialCharTok{+} \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values=}\NormalTok{sp\_cols)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-30-1.pdf}

}

\end{figure}

\hypertarget{une-fabrique-uxe0-graphes}{%
\section{\texorpdfstring{\texttt{\%+\%} : une fabrique à
graphes}{\%+\% : une fabrique à graphes}}\label{une-fabrique-uxe0-graphes}}

Plus haut, je vous ai promis que les graphes \texttt{ggplot2} étaient en
soit des machines à faire des graphes\footnote{on pourrait parler de
  fonctions, voire de fonction factories}. Imaginons que nous disposions
d'un autre jeu de données se présentant de la même façon, typiquement
avec les mêmes colonnes utilisées par un \texttt{ggplot} que vous auriez
construit avec amour et simplicité :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(iris2) }\SpecialCharTok{+} \FunctionTok{aes}\NormalTok{(pl, pw, }\AttributeTok{col=}\NormalTok{sp) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\NormalTok{gg}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-31-1.pdf}

}

\end{figure}

Et voilà un autre jeu de données, avec un peu de bruit gaussien pour
tout le monde :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_bis }\OtherTok{\textless{}{-}}\NormalTok{ iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{c}\NormalTok{(pl, pw), }\SpecialCharTok{\textasciitilde{}}\NormalTok{.x}\SpecialCharTok{+}\FunctionTok{rnorm}\NormalTok{(.x, }\AttributeTok{sd=}\FloatTok{0.5}\NormalTok{)))}
\NormalTok{iris\_bis}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 150 x 6
      sl    sw    pl      pw sp     session
   <dbl> <dbl> <dbl>   <dbl> <fct>  <fct>  
 1   5.1   3.5 1.91   0.335  setosa A      
 2   4.9   3   1.31  -0.0591 setosa A      
 3   4.7   3.2 1.30   0.271  setosa A      
 4   4.6   3.1 0.762  0.547  setosa A      
 5   5     3.6 0.973  0.385  setosa A      
 6   5.4   3.9 1.02   0.734  setosa A      
 7   4.6   3.4 1.19   0.415  setosa A      
 8   5     3.4 1.12   0.208  setosa A      
 9   4.4   2.9 1.12   0.582  setosa A      
10   4.9   3.1 1.57   0.682  setosa A      
# i 140 more rows
\end{verbatim}

Nous pouvons remplacer le jeu de données utilisé initialement par
\texttt{gg} (c'est à dire \texttt{iris2}) par votre nouveau jeu de
données (c'est à dire \texttt{iris\_bis}), en utilisant l'opérateur
\texttt{\%+\%} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{\%+\%}\NormalTok{ iris\_bis}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-33-1.pdf}

}

\end{figure}

Vous pouvez même modifier le ggplot ainsi obtenu. Ci-dessous, je pousse
le bouchon jusqu'à manipuler au tout dernier moment \texttt{iris\_bis}
pour ajouter un numéro d'individu séquentiel et ajouter une étiquette
avec \texttt{geom\_label}, une variante de \texttt{geom\_text}, tous
deux bien utiles. À y être, je rajouter aussi une petite annotation,
alignée à gauche sur le point \texttt{(1;\ 2.5)}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg2 }\OtherTok{\textless{}{-}}\NormalTok{ gg }\SpecialCharTok{\%+\%} \FunctionTok{mutate}\NormalTok{(iris\_bis, }\AttributeTok{i=}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{n}\NormalTok{()) }\SpecialCharTok{+} 
  \FunctionTok{geom\_label}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label=}\NormalTok{i)) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x=}\DecValTok{1}\NormalTok{, }\AttributeTok{y=}\FloatTok{2.5}\NormalTok{, }\AttributeTok{label=}\StringTok{"hello"}\NormalTok{, }\AttributeTok{hjust=}\DecValTok{0}\NormalTok{)}
\NormalTok{gg2}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-34-1.pdf}

}

\end{figure}

\hypertarget{un-package-bien-utile-patchwork}{%
\section{\texorpdfstring{Un package bien utile :
\texttt{patchwork}}{Un package bien utile : patchwork}}\label{un-package-bien-utile-patchwork}}

Quantité de packages existent pour étendre encore les fonctionnalités de
\texttt{ggplot2}. Nous pouvons citer :

\begin{itemize}
\tightlist
\item
  \texttt{plotly} : pour des graphes interactifs
\item
  \texttt{ggmap} : gestion des données spatiales et des projections
\item
  \texttt{ggrepel} : pour avoir des étiquettes de données non
  juxtaposées
\item
  \texttt{ggdendro}: representer des dendrogrammes et autres arbres
\item
  etc.
\end{itemize}

Nous ne présenterons que \texttt{patchwork}: qui permet l'assemblage
intuitif de graphes. Son fonctionnement est simplissime. Si vous avez
plusieurs \texttt{ggplot} vous pouvez les assembler, comme des
``méta-facet'' en quelque sorte. Les opérateurs \texttt{+} et \texttt{/}
construisent un seul \texttt{ggplot} juxta- ou superposés :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(patchwork)}
\NormalTok{gg }\SpecialCharTok{+}\NormalTok{ gg2}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-35-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gg }\SpecialCharTok{/}\NormalTok{ gg2}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-35-2.pdf}

}

\end{figure}

\texttt{plot\_layout} et \texttt{plot\_annotation} sont très utiles pour
des compositions plus sophistiquées.

Enfin, si vous avez non pas deux mais une quantité de graphes, par
exemple dans une liste, \texttt{wrap\_plots} fait le job.

Imaginons que je vous ai convaincu·e de ne désormais plus faire de
terrain et de simuler vos données. Imaginons que vous simuliez
\texttt{K}, disons 6, sessions de mesures.

Le \texttt{map} ci-dessous fera l'objet de tout le chapitre suivant.
Ici, un simple aperçu de sa puissance.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{K}\OtherTok{=}\DecValTok{6}
\CommentTok{\# simulate data}
\NormalTok{iris6 }\OtherTok{\textless{}{-}} \FunctionTok{map}\NormalTok{(}\FunctionTok{seq\_len}\NormalTok{(}\DecValTok{6}\NormalTok{), }
              \SpecialCharTok{\textasciitilde{}}\NormalTok{iris2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{c}\NormalTok{(pl, pw), }\SpecialCharTok{\textasciitilde{}}\NormalTok{.x}\SpecialCharTok{+}\FunctionTok{rnorm}\NormalTok{(.x, }\AttributeTok{sd=}\FloatTok{0.5}\NormalTok{))))}
\CommentTok{\# build the ggs}
\NormalTok{gg6 }\OtherTok{\textless{}{-}} \FunctionTok{map}\NormalTok{(iris6, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gg }\SpecialCharTok{\%+\%}\NormalTok{ .x)}
\CommentTok{\# patchwork them}
\FunctionTok{wrap\_plots}\NormalTok{(gg6, }\AttributeTok{ncol=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{plot\_layout}\NormalTok{(}\AttributeTok{guides=}\StringTok{"collect"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{ggplot2_files/figure-pdf/unnamed-chunk-36-1.pdf}

}

\end{figure}

\hypertarget{sauvez-vos-cruxe9ations-avec-ggsave}{%
\section{\texorpdfstring{Sauvez vos créations avec
\texttt{ggsave}}{Sauvez vos créations avec ggsave}}\label{sauvez-vos-cruxe9ations-avec-ggsave}}

Une fois que vous êtes satisfait·e de votre \texttt{ggplot}, vous pouvez
le sauver vers un \texttt{pdf}, \texttt{eps}, \texttt{jpg},
\texttt{png}, etc. facilement avec la fonction \texttt{ggsave}.

Il vous suffit d'appeller \texttt{ggsave} avec le nom de fichier et son
extension correspondant au format que vous voulez sauver. Vous pouvez
aussi spécifier la largeur et la hauteur de sortie. Par défaut
\texttt{ggsave} sauve le dernier graphe produit mais vous pouvez
spécifier l'argument \texttt{plot} de \texttt{ggsave}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"my\_plot\_1.pdf"}\NormalTok{, gg, }\AttributeTok{width=}\DecValTok{12}\NormalTok{, }\AttributeTok{height=}\DecValTok{8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{considuxe9rations-post-liminaires}{%
\section{Considérations
post-liminaires}\label{considuxe9rations-post-liminaires}}

\texttt{ggplot2} peut-être frustrant dans les premiers temps. Comme vous
le savez la frustration est typique mais temporaire. \texttt{ggplot2}
mérite définitivement de s'y accrocher et les larmes de hargne seront
bientôt remplacées par des cris de joie et des apéros en terrasse grâce
au temps gagné.

\bookmarksetup{startatroot}

\hypertarget{manipulation-de-listes-avec-purrr}{%
\chapter{\texorpdfstring{Manipulation de listes avec
\texttt{purrr}}{Manipulation de listes avec purrr}}\label{manipulation-de-listes-avec-purrr}}

Si vous n'avez besoin que de \texttt{purrr}, \texttt{library(purrr)}
charge le package. Si vous utilisez tout le tidyverse, \texttt{purrr}
sera chargée après :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\hypertarget{les-listes-cest-la-vie}{%
\section{Les listes c'est la vie}\label{les-listes-cest-la-vie}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{wagon1=}\StringTok{"pomme"}\NormalTok{, }\AttributeTok{wagon2=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{wagon3=}\FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{))}
\FunctionTok{length}\NormalTok{(z)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(z)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "wagon1" "wagon2" "wagon3"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(z)    }\CommentTok{\# structure of z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
List of 3
 $ wagon1: chr "pomme"
 $ wagon2: int [1:3] 1 2 3
 $ wagon3: logi [1:2] TRUE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# View(z) \# RStudio Viewer}
\NormalTok{z         }\CommentTok{\# simple print method}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$wagon1
[1] "pomme"

$wagon2
[1] 1 2 3

$wagon3
[1]  TRUE FALSE
\end{verbatim}

Ne soyez pas effrayé·e par les listes : elles sont simplement des
conteneurs pouvant accueillir des objets de classes différentes (ou non)
et de longueur différentes (ou non).

On peut se figurer une liste comme un train dont les éléments seraient
des wagons dont chacun contiendrait des conteneurs plus petits qui eux
contiennent des éléments :

\begin{verbatim}
  --  wagon 1  --        --  wagon 2  --       --  wagon 3  --
[    ["pomme"]    ] -- [    [ 1:3 ]     ] - [    [ c(TRUE, FALSE) ]    ]
\end{verbatim}

Une liste s'indexe de plusieurs façons, positionnellement ou avec le nom
de se(s) élément(s)-wagons s'ils sont nommés :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z[}\DecValTok{2}\NormalTok{]        }\CommentTok{\# using positionnal index}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$wagon2
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z[}\StringTok{"wagon2"}\NormalTok{] }\CommentTok{\# using ["name"]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$wagon2
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(z[}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "list"
\end{verbatim}

Notons que la syntaxe \texttt{z\$wagon2} fonctionne aussi.

Si l'on utilise les doubles crochets, on accède directement au contenu
des caisses dans les wagons. Ces derniers ont perdu leurs natures de
``wagon'', ne sont plus des listes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z[[}\DecValTok{2}\NormalTok{]]        }\CommentTok{\# using positionnal index}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z[[}\StringTok{"wagon2"}\NormalTok{]] }\CommentTok{\# using ["name"]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(z[[}\DecValTok{2}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "integer"
\end{verbatim}

Les assignations \texttt{list{[}index{]}\ \textless{}-} et
\texttt{list{[}{[}index{]}{]}\ \textless{}-} fonctionnent comme à
l'acoutumée.

\hypertarget{map-uxe0-la-vanille}{%
\section{\texorpdfstring{\texttt{map} à la
vanille}{map à la vanille}}\label{map-uxe0-la-vanille}}

Le package \texttt{purrr} s'articule autour de la famille \texttt{map}
dont il existe plusieurs variantes dont la première à voir est
\texttt{map} tout court.

L'idée est simple : appliquer une fonction à tous les éléments d'une
liste et retourner une liste. La liste sera le premier argument de
\texttt{map}, la fonction le second. Le nom de fonction est passé sans
parenthèses :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{map}\NormalTok{(z, class)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$wagon1
[1] "character"

$wagon2
[1] "integer"

$wagon3
[1] "logical"
\end{verbatim}

\hypertarget{map_-et-ses-autres-parfums}{%
\section{\texorpdfstring{\texttt{map\_*} et ses autres
parfums}{map\_* et ses autres parfums}}\label{map_-et-ses-autres-parfums}}

Dans l'exemple ci-dessus, si l'on ne veut pas de liste mais un vecteur
(quand cela est possible), on peut utiliser \texttt{unlist} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{map}\NormalTok{(class) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{unlist}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     wagon1      wagon2      wagon3 
"character"   "integer"   "logical" 
\end{verbatim}

Mais quand la classe de sortie d'une fonction map est homogène et
connue, on utilisera plutôt les variantes de map de la forme
\texttt{map\_*}. \texttt{*} pouvant prendre les valeurs \texttt{int} et
\texttt{dbl} pour retourner des \texttt{numeric} sous forme d'entiers ou
de doubles, \texttt{lgl} pour les vectuers logiques, \texttt{df},
\texttt{dfr} et \texttt{dfc} pour retourner des \texttt{data.frame},
éventuellement combinés par \texttt{r}ow ou \texttt{c}olonnes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{map\_chr}\NormalTok{(class)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     wagon1      wagon2      wagon3 
"character"   "integer"   "logical" 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{list}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\DecValTok{4}\SpecialCharTok{:}\DecValTok{9}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{map\_dbl}\NormalTok{(length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2 6
\end{verbatim}

\hypertarget{et-x-les-fonctions-anonymes-sont-vos-amies}{%
\section{\texorpdfstring{\texttt{\textasciitilde{}} et
\texttt{\textbackslash{}(x)} : les fonctions anonymes sont vos
amies}{\textasciitilde{} et \textbackslash(x) : les fonctions anonymes sont vos amies}}\label{et-x-les-fonctions-anonymes-sont-vos-amies}}

Dans \texttt{purrr} et plus largement dans le tidyverse, on peut
déclarer des fonctions anonymes, ``à la volée'' c'est à dire qu moment
où l'on en a besoin. \texttt{purrr} mobilise l'opérateur
\texttt{\textasciitilde{}} et la variable \texttt{.x}.

R ``de base'' a repris l'idée dans une saveur un peu différente avec
\texttt{\textbackslash{}(x)}. Ces trois approches sont équivalentes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5} \CommentTok{\# create a vector}
\CommentTok{\# option 1 : using a named function}
\NormalTok{square }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{map\_dbl}\NormalTok{(x, square)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  1  4  9 16 25
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# option 2 : purrr style anonymous function}
\FunctionTok{map}\NormalTok{(x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{.x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)    }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

[[5]]
[1] 25
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# option 3 : R base anonymous function}
\FunctionTok{map}\NormalTok{(x, \textbackslash{}(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

[[5]]
[1] 25
\end{verbatim}

\hypertarget{map2-et-guxe9nuxe9ralisation-pmap}{%
\section{\texorpdfstring{\texttt{map2} et généralisation
\texttt{pmap}}{map2 et généralisation pmap}}\label{map2-et-guxe9nuxe9ralisation-pmap}}

Imaginons que vous ayez deux listes \texttt{z1} et \texttt{z2} et que
chaque élément de \texttt{z1} doivent être élevé à la puissance de
chaque élément de \texttt{z2}. \texttt{purrr} généralise \texttt{map}
avec deux listes avec les fonctions \texttt{map2\_*} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z1 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\DecValTok{4}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{4.25}\NormalTok{), }\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\NormalTok{z2 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\FunctionTok{map2}\NormalTok{(z1, z2, \textbackslash{}(x, y) x}\SpecialCharTok{\^{}}\NormalTok{y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[1]]
[1] 16 25

[[2]]
[1] 3.00 2.00 4.25

[[3]]
[1]  1  8 27
\end{verbatim}

Si vous avez plus de trois listes, vous pouvez utiliser \texttt{pmap\_},
comme suit. Le premier argument sera une liste de toutes vos listes.
Imaginons qu'après avoir élevé à la puissance de \texttt{z2} nous
voulions ajouter une valeur dans \texttt{z3} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z3 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\DecValTok{10}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\FunctionTok{pmap}\NormalTok{(}\FunctionTok{list}\NormalTok{(z1, z2, z3), \textbackslash{}(x, y, z) x}\SpecialCharTok{\^{}}\NormalTok{y }\SpecialCharTok{+}\NormalTok{ z)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[1]]
[1] 26 35

[[2]]
[1] -2.00 -3.00 -0.75

[[3]]
[1]  1  8 27
\end{verbatim}

\hypertarget{opuxe9rations-sur-listes}{%
\section{Opérations sur listes}\label{opuxe9rations-sur-listes}}

\hypertarget{cheat-sheet-1}{%
\section{cheat sheet}\label{cheat-sheet-1}}

\bookmarksetup{startatroot}

\hypertarget{le-reste-du-tidyverse-au-pas-de-course-forcats-stringr-lubridate-et-readr}{%
\chapter{\texorpdfstring{Le reste du tidyverse au pas de course :
\texttt{forcats}, \texttt{stringr}, \texttt{lubridate} et
\texttt{readr}}{Le reste du tidyverse au pas de course : forcats, stringr, lubridate et readr}}\label{le-reste-du-tidyverse-au-pas-de-course-forcats-stringr-lubridate-et-readr}}

\hypertarget{forcats}{%
\section{\texorpdfstring{\texttt{forcats}}{forcats}}\label{forcats}}

\hypertarget{stringr}{%
\section{\texorpdfstring{\texttt{stringr}}{stringr}}\label{stringr}}

\hypertarget{lubridate}{%
\section{\texorpdfstring{\texttt{lubridate}}{lubridate}}\label{lubridate}}

\hypertarget{readr-1}{%
\section{\texorpdfstring{\texttt{readr}}{readr}}\label{readr-1}}

\bookmarksetup{startatroot}

\hypertarget{dictionnaire}{%
\chapter{Dictionnaire}\label{dictionnaire}}

Ci-dessous, le vocabulaire de base pour bien démarrer en R. Nous n'avons
pas tout vu mais vous savez comment trouver de l'aide pas vrai ?

\hypertarget{environnement}{%
\section{Environnement}\label{environnement}}

\begin{itemize}
\tightlist
\item
  \texttt{\textless{}-}, \texttt{assign} : assigne une valeur
\item
  \texttt{\%\textgreater{}\%}/\texttt{\textbar{}\textgreater{}} :
  \emph{forward pipe} \texttt{g(f(x))} devient
  \texttt{x\ \%\textgreater{}\%\ f\ \%\textgreater{}\%\ g}
\item
  \texttt{get/setwd} : accède et changer l'emplacement de travail
\item
  \texttt{here::here} est une alternative plus générique
\item
  \texttt{ls} : liste les objets dans l'environnement
\item
  \texttt{rm(list=ls())} : efface tous les objets mais votre ordinateur
  peut prendre feu\footnote{https://twitter.com/hadleywickham/status/940021008764846080}
\item
  \texttt{object.size} : taille d'un objet
\item
  \texttt{install.packages}/\texttt{library} : installe et charge des
  packages
\item
  \texttt{citation} : citer les gentils gens
\item
  \texttt{sessionInfo} : informations de session, notamment le
  versionnage
\end{itemize}

\hypertarget{arithmuxe9tique-1}{%
\section{Arithmétique}\label{arithmuxe9tique-1}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
opérateur & signification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{+} & addition \\
\texttt{-} & soustraction \\
\texttt{/} & division \\
\texttt{*} & multiplication \\
\texttt{\%\%} & modulo \\
\texttt{\%/\%} & division euclidienne \\
\texttt{\^{}} & puissance \\
\end{longtable}

\hypertarget{mathuxe9matiques}{%
\section{Mathématiques}\label{mathuxe9matiques}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
fonction & signification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{log} & logarithme (népérien) \\
\texttt{log10} & logarithme (décimal) \\
\texttt{exp} & exponentielle \\
\texttt{sum} & somme \\
\texttt{min} & minimum \\
\texttt{max} & maximum \\
\texttt{range} & étendue, raccourci pour \texttt{c(min(x),\ max(x))} \\
\texttt{median} & médiane \\
\texttt{quantile} & quantile (voir l'argument \texttt{probs}) \\
\texttt{summary} & un peu de tout ce qui précède \\
\texttt{round} & arrondi classique \\
\texttt{signif} & garde \texttt{n} chiffres \\
\texttt{floor} & arrondi inférieur \\
\texttt{ceiling} & arrondi supérieur \\
\texttt{var} & variance \\
\texttt{sd} & écart-type \\
\texttt{cor(x,\ y)} & corrélation \\
\texttt{cov(x,\ y)} & covariance \\
\texttt{cos} et al. & trigonométrie \\
\texttt{?Complex} & pour la gestion des complexes \\
\end{longtable}

\hypertarget{valeurs-spuxe9ciales}{%
\section{Valeurs spéciales}\label{valeurs-spuxe9ciales}}

\begin{itemize}
\tightlist
\item
  \texttt{NA} pour les valeurs manquantes. \texttt{na.omit} et les
  arguments \texttt{na.rm} aident à filtrer ces valeurs.
\item
  \texttt{NULL} : ensemble vide
\item
  \texttt{-Inf/Inf} : ±∞
\item
  \texttt{pi} et autres constantes (\texttt{?Constants}),
  \texttt{letters}
\item
  Beaucoup de jeux de données disponibles nativement, voir
  \texttt{?datasets} \#\# Arithmétique
\end{itemize}

\hypertarget{comparaison}{%
\section{Comparaison}\label{comparaison}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
opérateur & signification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{\textless{}} & strictement inférieur \\
\texttt{\textless{}=} & inférieur ou égal \\
\texttt{\textgreater{}} & strictement supérieur \\
\texttt{\textgreater{}=} & supérieur ou égal \\
\texttt{==} & égal \\
\texttt{!=} & différent \\
\texttt{\%in\%} & dans l'ensemble \\
\end{longtable}

\hypertarget{tests-logiques}{%
\section{Tests logiques}\label{tests-logiques}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
opérateur & signification \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{!} & NOT \\
\texttt{\&} & AND (élément par élément) \\
\texttt{\&\&} & AND \\
\texttt{\textbar{}} & OR (élément par élément) \\
\texttt{\textbar{}\textbar{}} & OR \\
\texttt{xor(x,\ y)} & OR (exclusif) \\
\texttt{all} & teste si uniquement des TRUE \\
\texttt{any} & teste si l'une des conditions au moins est TRUE \\
\end{longtable}

\hypertarget{control-flow-1}{%
\section{Control flow}\label{control-flow-1}}

\begin{itemize}
\tightlist
\item
  Toute la clique habituelle (\texttt{?Control}) : \texttt{if},
  \texttt{else}, \texttt{ifelse}, \texttt{for}, \texttt{while},
  \texttt{next}, \texttt{break}, etc.
\end{itemize}

\hypertarget{fonctions-2}{%
\section{Fonctions}\label{fonctions-2}}

\begin{verbatim}
nom_fonction <- function(arg1=default1, arg2=default2, ...) {
  # instructions
  return()
}
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Les arguments et leurs valeurs par défaut sont optionnels.
\item
  \texttt{return} n'est pas obligatoire, la dernière ligne est renvoyée.
  Ne rien retourner est possible
\item
  \texttt{list()} pour des retours de plus d'une valeur
\item
  fonctions anonymes, souvent créées à la volée:
  \texttt{function(.x)\ .x*2} ou \texttt{\textbackslash{}.x\ .x+2}.
  Souvent passé en \texttt{formula} à \texttt{map} (argument
  \texttt{.f}), par exemple : \texttt{\textasciitilde{}x+3}
\end{itemize}

\hypertarget{vecteurs}{%
\section{Vecteurs}\label{vecteurs}}

\begin{itemize}
\tightlist
\item
  \texttt{{[}i{]}/{[}i{]}\textless{}-} : accède et modifie les i-ème(s)
  position d'un vecteur
\item
  \texttt{c} : concatène des valeurs et crée un vecteur
\item
  \texttt{names/names\textless{}-} : accède et change les noms d'un
  vecteur
\item
  \texttt{sort} : ordonne un vecteur
\item
  \texttt{order} : ordonne un vecteur mais retourne les indices
\item
  \texttt{rev} : retourne un vecteur du dernier au premier élément
\item
  \texttt{unique} : retourne les valeurs distinctes
\item
  \texttt{table} : compte les valeurs d'un ou de plusieurs vecteurs
\end{itemize}

\hypertarget{suxe9quences-ruxe9guliuxe8res-et-aluxe9atoires}{%
\section{Séquences régulières et
aléatoires}\label{suxe9quences-ruxe9guliuxe8res-et-aluxe9atoires}}

\begin{itemize}
\tightlist
\item
  \texttt{seq} : séquences régulières
\item
  \texttt{a:b} : raccourci pour \texttt{seq(a,\ b)}
\item
  \texttt{rep} : répète un vecteur ou ses éléments
\item
  \texttt{runif/rnorm/rbinom} : nombres aléatoires issus d'une
  distribution uniforme, normale, binomiale. Voir
  \texttt{?Distributions}
\end{itemize}

\hypertarget{matrices}{%
\section{Matrices}\label{matrices}}

\begin{itemize}
\tightlist
\item
  \texttt{{[}i,\ j{]}} + \texttt{{[}i,\ j{]}\textless{}-} : accède et
  modifie les valeurs aux \texttt{i}-ième(s) et \texttt{j}-ième(s)
  indices (lignes puis colonnes)
\item
  \texttt{matrix/data.frame} : création
\item
  \texttt{is/as.matrix} et \texttt{is/as.data.frame} : test et
  conversion de type
\item
  \texttt{col/rownames} et \texttt{col/rownames\textless{}-} : accéder
  et définir row/colnames
\item
  \texttt{t} : transposition
\item
  \texttt{\%*\%} : multiplication matricielle (\texttt{matrix} only)
\item
  \texttt{apply} : opération marginale
\item
  \texttt{row/colSums} : raccourci pour \texttt{apply(m,\ 1/2,\ sum)}
\end{itemize}

\hypertarget{listes}{%
\section{Listes}\label{listes}}

\hypertarget{dplyr-manipulation-de-data.frame}{%
\section{\texorpdfstring{\texttt{dplyr} : Manipulation de
data.frame}{dplyr : Manipulation de data.frame}}\label{dplyr-manipulation-de-data.frame}}

\begin{itemize}
\tightlist
\item
  RStudio :
  \texttt{Help\ \textgreater{}\ Cheatsheets\ \textgreater{}\ dplyr} :
  très bonne adresse
\item
  \texttt{vignette(package="dplyr")}, par ex. \texttt{vignette("dplyr")}
\item
  on préférera les tibbles qui apportent des améliorations cosmétiques
  aux data.frame (\texttt{as\_tibble})
\item
  \texttt{tibble} et \texttt{tribble} pour le constructeur
\item
  \texttt{slice} : filtre sur les lignes avec des indices
\item
  \texttt{filter} : filtre sur les lignes avec des tests logiques
\item
  \texttt{select} : sélectionner et réordonne les colonnes
\item
  \texttt{starts\_with} et autres helpers de \texttt{tidyselect}
\item
  \texttt{rename} : renomme les colonnes
\item
  \texttt{mutate} : crée de nouvelles colonnes
\item
  \texttt{group\_by}/\texttt{ungroup} : groupe, déproupe par colonnes
\item
  \texttt{summarise} : résume en 1 ligne ou 1 ligne par groupe, des
  colonnes
\item
  \texttt{group\_split} : tranche une tibble par groupe
\item
  \texttt{bind\_rows/cols} : colle par lignes ou colonnes
\item
  \texttt{*\_join} : opérations de join sur deux tables partageant un
  index
\end{itemize}

\hypertarget{stringr-manipulation-de-chaines-de-caractuxe8res}{%
\section{\texorpdfstring{\texttt{stringr} : manipulation de chaines de
caractères}{stringr : manipulation de chaines de caractères}}\label{stringr-manipulation-de-chaines-de-caractuxe8res}}

\begin{itemize}
\tightlist
\item
  \texttt{vignette(package="stringr")}, par ex.
  \texttt{vignette("stringr")}
\end{itemize}

\hypertarget{ggplot2-un-grammaire-pour-les-graphes}{%
\section{\texorpdfstring{\texttt{ggplot2} : un grammaire pour les
graphes}{ggplot2 : un grammaire pour les graphes}}\label{ggplot2-un-grammaire-pour-les-graphes}}

\begin{itemize}
\tightlist
\item
  \texttt{vignette(package="ggplot2")}, par ex.
  \texttt{vignette("ggplot2")}
\item
  RStudio :
  \texttt{Help\ \textgreater{}\ Cheatsheets\ \textgreater{}\ ggplot2} :
  très bonne adresse
\end{itemize}

\hypertarget{forcats-manipulation-de-facteurs}{%
\section{\texorpdfstring{\texttt{forcats} : manipulation de
facteurs}{forcats : manipulation de facteurs}}\label{forcats-manipulation-de-facteurs}}

\begin{itemize}
\tightlist
\item
  \texttt{vignette(package="forcats")}, par ex.
  \texttt{vignette("forcats")}
\end{itemize}

\hypertarget{purrr-travailler-avec-des-listes}{%
\section{\texorpdfstring{\texttt{purrr} : travailler avec des
listes}{purrr : travailler avec des listes}}\label{purrr-travailler-avec-des-listes}}

\begin{itemize}
\tightlist
\item
  \texttt{vignette(package="purrr")}, par ex. \texttt{vignette("purrr")}
\item
  RStudio :
  \texttt{Help\ \textgreater{}\ Cheatsheets\ \textgreater{}\ purrr} :
  très bonne adresse
\item
  \texttt{map(liste,\ function)} : travaille sur une liste, retourne une
  liste
\item
  \texttt{map(liste,\ \textasciitilde{}.x\ \%\textgreater{}\%\ ...)} :
  accepte les fonctions anonymes
\item
  \texttt{map\_\{dbl,\ chr,\ lgl,\ df,\ dfr,\ dfc\}} : idem mais
  retourne des numeric, character, logical, data.frame, data.frame
  collés par lignes/colonnes
\item
  \texttt{map2\_*(liste1,\ liste2,\ ...)} : idem pour deux listes
\item
  \texttt{pmap\_*} : généralisation à N listes
\end{itemize}

\hypertarget{importexport}{%
\section{Import/Export}\label{importexport}}

\begin{itemize}
\tightlist
\item
  texte brut : \texttt{readLines}
\item
  lire des tables : \texttt{read.table}, \texttt{readr::read\_csv},
  \texttt{xlsx::read.xlsx}.
\item
  \texttt{Import\ dataset} dans RStudio est moins pénible de prime abord
\item
  écrire des tables : \texttt{write.table}, \texttt{readr::write\_csv},
  \texttt{xlsx::write.xlsx}
\item
  \texttt{save/load} : sauve et charge un objet R/\texttt{.rda}
\item
  pour les plots de \texttt{graphics} :
  \texttt{pdf(...)\ \{...\}\ dev.off()}
\item
  pour les ggplot de \texttt{ggplot2} : \texttt{ggsave}
\end{itemize}

\hypertarget{interactions-audio-visuelles}{%
\section{Interactions
audio-visuelles}\label{interactions-audio-visuelles}}

\begin{itemize}
\tightlist
\item
  bips : package \texttt{beepr}
\item
  barres de progression : package \texttt{progress}
\item
  invite de commande : \texttt{readline}
\item
  logs : \texttt{sink}
\item
  \texttt{Sys.sleep}, \texttt{Sys.time}, \texttt{Sys.*} : pause,
  horodatage, autres interactions
\end{itemize}

\bookmarksetup{startatroot}

\hypertarget{ressources}{%
\chapter{Ressources}\label{ressources}}

\hypertarget{must-see}{%
\section{Must see}\label{must-see}}

\begin{itemize}
\tightlist
\item
  \href{http://stackoverflow.com/tags/r/info}{\texttt{{[}R{]}} chez
  Stack Overflow}
\end{itemize}

\hypertarget{moteur-de-recherche}{%
\section{Moteur de recherche}\label{moteur-de-recherche}}

\begin{itemize}
\tightlist
\item
  \href{http://rseek.org/}{Rseek} dédié à R
\end{itemize}

\hypertarget{journaux}{%
\section{Journaux}\label{journaux}}

\begin{itemize}
\tightlist
\item
  \href{http://journal.r-project.org/}{\emph{R-Journal}} : la gazette de
  R avec les nouveaux packages, des astuces, des articles techniques.
  \emph{Open access}.
\item
  \href{http://www.jstatsoft.org/}{\emph{Journal of Statistical
  Software}} : officiellement multilangages, en pratique, beaucoup de
  nouveaux packages R. \emph{Open access}.
\end{itemize}

\hypertarget{manuels}{%
\section{Manuels}\label{manuels}}

\begin{itemize}
\tightlist
\item
  D'excellents tutoriels sont regroupés sur le
  \href{http://cran.r-project.org/other-docs.html}{site du CRAN}, en
  anglais et d'autres langues.
\item
  \href{http://cran.r-project.org/manuals.html}{\emph{Documentation
  officielle}}, éditée par la \emph{R Development Core Team} :
  introduction à R, définition du langage \emph{per se}, package
  authoring, etc. : assez aride et souvent très technique (et pas
  uniquement pour les novices) mais reste la référence absolue.
\item
  \href{http://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr.pdf}{\emph{R
  pour les débutants} {[}fr{]}},
  \href{http://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf}{{[}en{]}}
  : la mère de tous les tutoriels courts sur R, très complete
  introduction à R, une excellent adresse par Emmanuel Paradis.
\item
  \href{http://cran.r-project.org/doc/contrib/Barnier-intro_R.pdf}{\emph{Une
  introduction à R}} : une autre excellente ressource, par Julien
  Barnier.
\item
  \href{http://cran.r-project.org/doc/contrib/Herve-Aide-memoire-statistique.pdf}{\emph{Aide
  mémoire de statistique appliquée à la biologie}} : un document très
  concis et très utile par Maxime Hervé. Malgré non nom, sa portée est
  au delà de la biologie et globalement une bon résumé pour l'analyse
  statistique depuis la préparation jusqu'à l'analyse.
\end{itemize}

\hypertarget{ouvrages}{%
\section{Ouvrages}\label{ouvrages}}

\begin{itemize}
\tightlist
\item
  \href{http://www.sagepub.com/dsur/main.htm}{\emph{Discover statistics
  using R}} (2012) par Andy Field, Jeremy Miles et Zoë Field (992pp.)
  chez \emph{Sage}. Une excellente ressource très complète et vivante.
\item
  \href{http://eu.wiley.com/WileyCDA/WileyTitle/productCd-0470973927.html}{\emph{The
  R Book}} (2012) Seconde édition par Michael J. Crawley. Une autre
  bonne ressource, complète, sur R.
\item
  \href{https://r4ds.had.co.nz/}{* R for Data Science*} LA référence
\item
  \href{http://www.springer.com/series/6991}{\emph{Use R!}} Série (50+
  ouvrages) publiée chez \emph{Springer}. Généralement excellente et
  focalisée sur une problématique
\item
  \href{http://adv-r.had.co.nz/}{\emph{Advanced R}} par Hadley Wickham.
  En ligne et en version imprimée. Plongée dans la tambouille interne de
  R.
\item
  \href{http://r-pkgs.had.co.nz/}{\emph{R packages}} par Hadley Wickham.
  En ligne et en version imprimée. Une excellente et concise
  introduction à l'écriture de packages.
\item
  \href{https://csgillespie.github.io/efficientR/}{\emph{Efficient R
  programming}} par Colin Gillespie et Robin Lovelace. Un cran plus
  loin, et meilleur, pour les programmeurs avertis.
\item
  \href{http://www.burns-stat.com/documents/books/s-poetry/}{\emph{S
  poetry}}: un livre sur les origines de R, sur l'élégance de S.
\item
  \href{http://www.burns-stat.com/documents/books/the-r-inferno/}{\emph{The
  R Inferno}}: le contre-point du précédent, par le même auteur, sur les
  singularités de R.
\item
  \href{http://r-pkgs.had.co.nz/}{\emph{R packages}} par Hadley Wickham.
  En ligne et en version imprimée. Une excellente et concise
  introduction à l'écriture de packages.
\end{itemize}

\hypertarget{sites}{%
\section{Sites}\label{sites}}

\begin{itemize}
\tightlist
\item
  \href{http://www.r-bloggers.com/}{\emph{R-bloggers}} : aggrégation de
  blogs qui traitent de R, quelques posts par jour, éclectique, une
  excellente ressource pour être à la page. tl;dr: un best-of
  \href{http://www.r-bloggers.com/?s=in+case+you+missed+it}{ici}
\item
  \href{http://crantastic.org/}{\emph{crantastic}} : un site qui
  récupère toute l'activité sur les dépôts de packages. Permet de
  reviewer des packages, de chercher par auteur, etc.
\item
  \href{https://rpubs.com/}{RPubs} : sérendipité, me voilà !
\item
  \href{http://rgraphgallery.blogspot.fr/search/label/map}{\emph{R graph
  gallery}} : collection de graphiques, qui ne fera pas oublier la
  gallerie ``addicted to R'' qui est en maintenance ou abandonnée depuis
  un bail
\item
  \href{http://blog.rstudio.org/}{\emph{R-Studio's blog}} : par l'équipe
  de R Studio, dernières actualités du développement de R Studio et des
  packages par son équipe
\item
  \href{http://cran.r-project.org/web/views/}{CRAN Views} : pour bien
  commencer avec les packages
\item
  \href{https://en.wikipedia.org/wiki/Portal:Statistics}{Portail
  Wikipédia des statistiques {[}en{]}} : en attendant le bus, le métro,
  le train, le dodo, une excellente et quasi infinie ressource.
\item
  \href{http://lib.stat.cmu.edu/DASL/}{\emph{The Data and Story
  Library}} : des jeux de données célèbres, accompagnés de leurs
  histoires.
\item
  \href{http://kbroman.org/pages/tutorials.html}{Karl Broman} : tous ses
  tutoriels sont délicieux et en particulier :
  \href{https://github.com/kbroman/dataorg}{préparation de données dans
  un tableur} et \href{https://github.com/kbroman/hipsteR}{rééducation R
  pour les gens qui l'ont appris avec qu'il ne deviennent cool}
\item
  \href{http://pbil.univ-lyon1.fr/R/}{PBIL} : Statistiques pour la
  biologie (mais pas que, loin de là) par l'université de Lyon.
\item
  \href{http://wikistat.fr/}{WikiStats} : ressources statistiques par
  l'INSA et le département de maths de l'université de Toulouse.
\end{itemize}

\hypertarget{cheatsheets}{%
\section{Cheatsheets}\label{cheatsheets}}

\begin{itemize}
\tightlist
\item
  \href{https://www.rstudio.com/resources/cheatsheets/}{RStudio's,
  dplyr, shiny, rmarkdown, etc. cheatsheets} : génial
\item
  \href{http://adv-r.had.co.nz/Vocabulary.html}{R Vocabulary} : back to
  basics
\item
  \href{https://cran.r-project.org/doc/contrib/Baggott-refcard-v2.pdf}{Magott
  et al.'s refcard} : ma préférée
\item
  \href{https://cran.r-project.org/doc/contrib/refcard.pdf}{Jonathan
  Baron's refcard}
\item
  \href{https://cran.r-project.org/doc/contrib/Short-refcard.pdf}{Tom
  Short's refcard}
\item
  \href{https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf}{Colors
  cheatsheet}
\end{itemize}

\hypertarget{style-guides}{%
\section{Style guides}\label{style-guides}}

\begin{itemize}
\tightlist
\item
  \href{https://google.github.io/styleguide/Rguide.xml}{Google's R style
  guide} : longtemps la référence
\item
  \href{http://adv-r.had.co.nz/Style.html}{Hadley Wickham's style guide}
  : plus courte, meilleure à l'usage et dans l'usage
\end{itemize}

\hypertarget{miscellanuxe9es}{%
\section{Miscellanées}\label{miscellanuxe9es}}

\begin{itemize}
\tightlist
\item
  \href{https://en.wikipedia.org/wiki/Rubber_duck_debugging}{Débug et
  canard en plastique}
\item
  \href{http://www.sumsar.net/blog/2014/07/estimate-your-bac-using-drinkr/}{Calculer
  son alcoolémie avec R}
\item
  \href{http://www.butbn.cas.cz/francesco/Webpage/Gourmet.html}{La
  recette des falafels avec R}
\item
  \href{http://kh-tps.osu.edu/read.pdf}{Une autre liste de ressources}
\end{itemize}

\hypertarget{quotes}{%
\section{Quotes}\label{quotes}}

\begin{itemize}
\tightlist
\item
  Tout \href{https://github.com/kbroman/datasciquotes}{ici} est
  délicieux mais on peut rajouter :
\end{itemize}

\begin{quote}
Frustration is typical and temporary - Hadley Wickham
\end{quote}

\begin{quote}
If the statistics are boring, then you've got the wrong numbers. -
Edward Tufte
\end{quote}

\begin{quote}
Always code as if the guy who ends up maintaining your code will be a
violent psychopath who knows where you live. - John Wood
\end{quote}

\begin{quote}
At their best, graphics are tools for reasonning about quantitative
information. - Edward Tufte
\end{quote}

\begin{quote}
There are three types of lies - lies, damn lies, and statistics. ―
Benjamin Disraeli
\end{quote}

\begin{quote}
Les statistiques sont comme la dentelle des petites culottes : elles
révèlent le superflu mais cachent l'essentiel - ?
\end{quote}

\begin{quote}
L'analyse statistique n'est vraiment utile qu'à des personnes qui n'en
n'ont pas la maîtrise, et n'est maîtrisée que par des personnes qui n'en
n'ont pas vraiment l'usage - Daniel Chessel
\end{quote}



\end{document}
